function deleteRoster(e){localStorage.setItem("selectedRosterID",e)}function endTournamentConfirmation(e){myApp.closeModal("#popover-tournament"),localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")?myApp.alert("You are not allowed to end the game"):0==e&&(1==checkInternetConnection()?(myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"end_tournament.php",data:"tournament_id="+localStorage.getItem("selectedTournamentId"),dataType:"json",success:function(e,t,a){myApp.hideIndicator(),myApp.alert(e.message),0==e.status&&mainView.router.reloadPage("tournament_detail.html?tournament_id="+localStorage.getItem("selectedTournamentId"))},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT)}})):myApp.alert(NO_INTERNET_ALERT))}function endVoteConfirmation(e){myApp.closeModal("#popover-tournament"),localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")&&0==e?myApp.alert("You are not allowed to end the vote"):0==e?myApp.confirm("Are you sure you want to end the vote?",function(){1==checkInternetConnection()?(myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"check_voting_result.php",data:"tournament_id="+localStorage.getItem("selectedTournamentId"),dataType:"json",success:function(e,t,a){if(myApp.hideIndicator(),0==e.status)if(1==e.vote_count){var i=e.roster_id;myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"update_vote_count.php",data:"roster_id="+i,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),0==e.status&&(mainView.router.loadPage("voting_result.html"),myApp.alert("Vote ended successfully!"))},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT)}})}else myApp.confirm("Oops! There was a tie, would you like to reset the voting for the top rosters?",function(){myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"reset_voting.php",data:"tournament_id="+localStorage.getItem("selectedTournamentId")+"&top_vote="+e.top_vote,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),myApp.alert(e.message),mainView.router.reloadPage("tournament_detail.html?tournament_id="+localStorage.getItem("selectedTournamentId"))},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT)}})});else myApp.alert(e.msg)},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT)}})):myApp.alert(NO_INTERNET_ALERT)}):mainView.router.loadPage("voting_result.html")}function shareMVPOnTwitter(e,t,a,i,n,o){if(""==imgfile)myApp.alert("Please take a picture of the MVP!"),myApp.closeModal(".popover");else{var r="",l=localStorage.getItem("mvp_team_name"),s=localStorage.getItem("mvp_opponent_name"),d=localStorage.getItem("mvp_roster_name");localStorage.getItem("mvp_roster_image");3==localStorage.getItem("selectedSportID")||4==localStorage.getItem("selectedSportID")?r="Congratualtions! You are MV! Tillykke! Du er kampens spiller! \n"+l+" vs "+s+"\n"+d+"\nvotes: "+o+"\ngoals/m책l: "+e+"\nassists: "+t+"\nyellow card: "+i+"\nred card: "+n+"\n":2==localStorage.getItem("selectedSportID")||5==localStorage.getItem("selectedSportID")?r="Congratualtions! You are MV! Tillykke! Du er kampens spiller! \n"+l+" vs "+s+"\n"+d+"\nvotes: "+o+"\ngoals/m책l: "+e+"\nassists: "+t+"\nfouls: "+a+"\n":(1==localStorage.getItem("selectedSportID")||6==localStorage.getItem("selectedSportID"))&&(r="Congratualtions! You are MV! Tillykke! Du er kampens spiller! \n"+l+" vs "+s+"\n"+d+"\nvotes: "+o+"\npoints: "+e+"\nassists: "+t+"\nfouls: "+a+"\n"),window.plugins.socialsharing.shareViaTwitter(r,imgfile,"http://envp.dk/",null,function(e){alert("Twitter Error: "+JSON.stringify(e)),myApp.closeModal(".popover")})}}function shareMVPOnFacebook(e,t,a,i,n,o){var r="",l="",s=localStorage.getItem("mvp_team_name"),d=localStorage.getItem("mvp_opponent_name"),p=localStorage.getItem("mvp_roster_name"),r=localStorage.getItem("mvp_roster_image");3==localStorage.getItem("selectedSportID")||4==localStorage.getItem("selectedSportID")?l=p+":\nvotes: "+o+"\ngoals/m책l: "+e+"\nassists: "+t+"\nyellow card: "+i+"red card: "+n:2==localStorage.getItem("selectedSportID")||5==localStorage.getItem("selectedSportID")?l=p+":\nvotes: "+o+"\ngoals/m책l: "+e+"\nassists: "+t+"\nfouls: "+a:(1==localStorage.getItem("selectedSportID")||6==localStorage.getItem("selectedSportID"))&&(l=p+":\nvotes: "+o+"\npoints: "+e+"\nassists: "+t+"\nfouls: "+a);var m=r;if(""!=imgfile){myApp.showIndicator();var c=new FileUploadOptions;c.fileKey="file",c.fileName=imgfile.substr(imgfile.lastIndexOf("/")+1),c.mimeType="image/jpeg",c.chunkedMode=!1;var u=new FileTransfer;u.upload(imgfile,ENVYP_API_URL+"upload_mvp_image.php",winMVP,fail,c),m=localStorage.getItem("mvp_image_url")}facebookConnectPlugin.showDialog({method:"feed",href:"http://envp.dk",caption:"Congratualtions! You are MV! Tillykke! Du er kampens spiller! \n"+s+" vs "+d,description:l,picture:m,share_feedWeb:!0},function(e){console.log(e),myApp.closeModal(".popover")},function(e){console.log(e),myApp.closeModal(".popover")})}function shareMVPOnInstagram(e,t,a,i,n,o,r){try{Instagram.isInstalled(function(e,t){if(t)if(""==imgfile)myApp.alert("Please take a picture of the MVP!"),myApp.closeModal(".popover");else{var a=imgfile,i="";getDataUri(a,function(e){Instagram.share(e,i,function(e){e||myApp.alert("Success!")})})}else myApp.alert("Instagram is not installed"),myApp.closeModal(".popover")})}catch(l){myApp.alert("Instagram Error: "+l.message),myApp.closeModal(".popover")}}function getDataUri(e,t){var a=new Image;a.onload=function(){var e=document.createElement("canvas");e.width=this.naturalWidth,e.height=this.naturalHeight,e.getContext("2d").drawImage(this,0,0),t(e.toDataURL("image/png"))},a.src=e}function getTournamentImage(){myApp.modal({title:"Choose Tournament Image",verticalButtons:!0,buttons:[{text:"Take new picture",onClick:function(){try{navigator.camera.getPicture(attachTournamentImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.CAMERA,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Select from gallery",onClick:function(){try{navigator.camera.getPicture(attachTournamentImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Cancel",onClick:function(){}}]})}function editTournamentImage(){myApp.modal({title:"Choose Tournament Image",verticalButtons:!0,buttons:[{text:"Take new picture",onClick:function(){try{navigator.camera.getPicture(attachEditTournamentImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.CAMERA,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Select from gallery",onClick:function(){try{navigator.camera.getPicture(attachEditTournamentImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Cancel",onClick:function(){}}]})}function getRosterImage(){myApp.modal({title:"Choose Roster Image",verticalButtons:!0,buttons:[{text:"Take new picture",onClick:function(){try{navigator.camera.getPicture(attachRosterImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.CAMERA,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Select from gallery",onClick:function(){try{navigator.camera.getPicture(attachRosterImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Cancel",onClick:function(){}}]})}function editRosterImage(){myApp.modal({title:"Choose Roster Image",verticalButtons:!0,buttons:[{text:"Take new picture",onClick:function(){try{navigator.camera.getPicture(attachEditRosterImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.CAMERA,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Select from gallery",onClick:function(){try{navigator.camera.getPicture(attachEditRosterImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Cancel",onClick:function(){}}]})}function getTeamImage(){myApp.modal({title:"Choose Team Image",verticalButtons:!0,buttons:[{text:"Take new picture",onClick:function(){try{navigator.camera.getPicture(attachTeamImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.CAMERA,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Select from gallery",onClick:function(){try{navigator.camera.getPicture(attachTeamImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Cancel",onClick:function(){}}]})}function editTeamImage(){myApp.modal({title:"Choose Team Image",verticalButtons:!0,buttons:[{text:"Take new picture",onClick:function(){try{navigator.camera.getPicture(attachEditTeamImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.CAMERA,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Select from gallery",onClick:function(){try{navigator.camera.getPicture(attachEditTeamImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Cancel",onClick:function(){}}]})}function getMVPImage(){myApp.modal({title:"Choose MVP Image",verticalButtons:!0,buttons:[{text:"Take new picture",onClick:function(){try{navigator.camera.getPicture(attachMVPImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.CAMERA,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Select from gallery",onClick:function(){try{navigator.camera.getPicture(attachMVPImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Cancel",onClick:function(){}}]})}function getProfileImage(){myApp.modal({title:"Choose Profile Image",verticalButtons:!0,buttons:[{text:"Take new picture",onClick:function(){try{navigator.camera.getPicture(attachProfileImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.CAMERA,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Select from gallery",onClick:function(){try{navigator.camera.getPicture(attachProfileImage,function(e){myApp.alert("No image selected")},{quality:100,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY,targetWidth:400,targetHeight:400,correctOrientation:!0})}catch(e){myApp.alert("camera error: "+e.message)}}},{text:"Cancel",onClick:function(){}}]})}function chooseLanguage(){myApp.modal({title:"Choose Language",horizontalButtons:!0,buttons:[{text:"English",onClick:function(){localStorage.setItem("selectedLanguage","1"),$("#lbl-choose-sports").empty(),$("#lbl-choose-sports").prepend("Choose Sports"),$("#lbl-profile").empty(),$("#lbl-profile").prepend("Profile"),$("#btn-my-teams").empty(),$("#btn-my-teams").prepend("My Teams"),$("#btn-edit-profile").empty(),$("#btn-edit-profile").prepend("Edit Profile"),$("#btn-inbox").empty(),$("#btn-inbox").prepend("Inbox"),$("#btn-choose-language").empty(),$("#btn-choose-language").prepend("Language"),$("#btn-settings").empty(),$("#btn-settings").prepend("Settings"),$("#btn-logout").empty(),$("#btn-logout").prepend("Logout"),$("#lbl-team-settings").empty(),$("#lbl-team-settings").prepend("Settings"),$("#lbl-team-participants").empty(),$("#lbl-team-participants").prepend("Participants"),$("#lbl-team-administrators").empty(),$("#lbl-team-administrators").prepend("Administrators")}},{text:"Danish",onClick:function(){localStorage.setItem("selectedLanguage","2"),$("#lbl-choose-sports").empty(),$("#lbl-choose-sports").prepend("V챈lg Sport"),$("#lbl-profile").empty(),$("#lbl-profile").prepend("Profil"),$("#btn-my-teams").empty(),$("#btn-my-teams").prepend("Mine Teams"),$("#btn-edit-profile").empty(),$("#btn-edit-profile").prepend("Rediger profil"),$("#btn-inbox").empty(),$("#btn-inbox").prepend("Indbakke"),$("#btn-choose-language").empty(),$("#btn-choose-language").prepend("Sprog"),$("#btn-settings").empty(),$("#btn-settings").prepend("Indstillinger"),$("#btn-logout").empty(),$("#btn-logout").prepend("Log ud"),$("#lbl-team-settings").empty(),$("#lbl-team-settings").prepend("Indstillinger"),$("#lbl-team-participants").empty(),$("#lbl-team-participants").prepend("Deltagere"),$("#lbl-team-administrators").empty(),$("#lbl-team-administrators").prepend("Administratorer")}},{text:"Cancel",onClick:function(){}}]})}function attachTournamentImage(e){imgfile=e,$$("#tournament-image").attr("src",imgfile)}function attachEditTournamentImage(e){imgfile=e,$$("#edit-tournament-image").attr("src",imgfile)}function attachRosterImage(e){imgfile=e,$$("#roster-image").attr("src",imgfile)}function attachEditRosterImage(e){imgfile=e,$$("#edit-roster-image").attr("src",imgfile)}function attachTeamImage(e){imgfile=e,$$("#team-image").attr("src",imgfile)}function attachEditTeamImage(e){imgfile=e,$$("#team-edit-image").attr("src",imgfile)}function attachProfileImage(e){imgfile=e,$$("#profile-image").attr("src",imgfile)}function attachMVPImage(e){imgfile=e,$$("#img-mvp-image").attr("src",imgfile)}function win(e){var t=JSON.parse(e.response);myApp.alert(t.message)}function winRoster(e){myApp.hideIndicator();var t=JSON.parse(e.response);myApp.alert(t.message)}function winUpdateUser(e){var t=JSON.parse(e.response);myApp.alert(t.message),"0"==t.status&&(localStorage.setItem("account_image",t.account_image),$$("#img-profile-image").attr("src",t.account_image))}function winMVP(e){myApp.hideIndicator();var t=JSON.parse(e.response);"0"==t.status&&localStorage.setItem("mvp_image_url",t.image_url)}function winTeamAdd(e){var t=JSON.parse(e.response);myApp.alert(t.message),"0"==t.status&&mainView.router.loadPage("team_management.html?team_id="+t.team_id+"&team_name="+t.team_name+"&team_password="+t.team_password)}function fail(e){myApp.alert("An error has occurred with error code "+e.code+", please try again.")}function getTeamPassword(e,t,a,i,n,o){t!=localStorage.getItem("account_id")?isAccountInvited(e,function(o){1==o.status?myApp.modalPassword("Please enter a password",function(r){r==i?(localStorage.setItem("currentAccountIsTeamAdmin",o.is_admin),mainView.router.loadPage("team_management.html?team_id="+e+"&team_name="+a+"&team_admin="+t+"&team_image="+n+"&team_password="+i)):myApp.alert("Incorrect team password!")}):myApp.alert("You are not invited on this event")}):mainView.router.loadPage("team_management.html?team_id="+e+"&team_name="+a+"&team_admin="+t+"&team_image="+n+"&team_password="+i),localStorage.setItem("backTournament",o)}function isAccountInvited(e,t){myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"check_if_account_invited.php",data:"account_id="+localStorage.getItem("account_id")+"&team_id="+e,dataType:"json",success:function(e,a,i){myApp.hideIndicator(),t(e)},error:function(e,t,a){myApp.hideIndicator()}})}function getParticipantList(){if($("#list-view-participants").empty(),"1"==localStorage.getItem("selectedLanguage"))var e="Add participants";else var e="Tilf첩j deltagere";(localStorage.getItem("currentTeamAdmin")==localStorage.getItem("account_id")||1==localStorage.getItem("currentAccountIsTeamAdmin"))&&$("#list-view-participants").prepend('<li><div class="item-content"><div class="item-inner"><div class="item-title"><a href="account_list.html" class="link"><font size="2">'+e+"</font></a></div></div></div></li>");myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_participant_list.php?team_id="+localStorage.getItem("selectedTeamID"),function(e){$.each(e,function(e,t){if("empty"==t.status)$("#list-view-participants").append('<li><div class="item-content"><div class="item-inner"><div class="item-title"><font size="2">No participants</font></div></div></div></li>');else{var a=""==t.image_url||null==t.image_url?"img/profile.jpg":t.image_url;$("#list-view-participants").append('<li><div class="item-content"><div class="item-media"><img src="'+a+'" class="img-circle" style="width:44px; height:44px;"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">'+t.first_name+" "+t.last_name+'</div><div class="item-after"><i onClick="removeParticipant('+t.account_id+');" class="fa fa-times link-remove-participant" aria-hidden="true"></i></div></div><div class="item-subtitle">'+t.account_description+"</div></div></div></li>")}localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")&&$(".link-remove-participant").hide()}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}function getTeamAdministratorList(){if($("#list-view-administrator").empty(),"1"==localStorage.getItem("selectedLanguage"))var e="Add administrator";else var e="Tilf첩j administrator";(localStorage.getItem("currentTeamAdmin")==localStorage.getItem("account_id")||1==localStorage.getItem("currentAccountIsTeamAdmin"))&&$("#list-view-administrator").prepend('<li><div class="item-content"><div class="item-inner"><div class="item-title"><a href="administrator_list.html" class="link"><font size="2">'+e+"</font></a></div></div></div></li>");myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_team_administrator_list.php?team_id="+localStorage.getItem("selectedTeamID"),function(e){$.each(e,function(e,t){if("empty"==t.status)$("#list-view-administrator").append('<li><div class="item-content"><div class="item-inner"><div class="item-title"><font size="2">No administrator</font></div></div></div></li>');else{var a=""==t.image_url||null==t.image_url?"img/profile.jpg":t.image_url;$("#list-view-administrator").append('<li><div class="item-content"><div class="item-media"><img src="'+a+'" class="img-circle" style="width:44px; height:44px;"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">'+t.first_name+" "+t.last_name+'</div><div class="item-after"><i onClick="removeAsAdministrator('+t.account_id+');" class="fa fa-times link-remove-administrator" aria-hidden="true"></i></div></div><div class="item-subtitle">'+t.account_description+"</div></div></div></li>")}localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")&&$(".link-remove-administrator").hide()}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}function removeParticipant(e){myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"delete_participant.php",data:"account_id="+e,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),0==e.status?(getParticipantList(),getTeamAdministratorList()):console.log(e.message)},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT)}})}function removeAsAdministrator(e){myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"delete_administrator.php",data:"account_id="+e+"&team_id="+localStorage.getItem("selectedTeamID"),dataType:"json",success:function(e,t,a){myApp.hideIndicator(),0==e.status?(getParticipantList(),getTeamAdministratorList()):console.log(e.message)},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT)}})}function addPushNotificationID(){""!=localStorage.getItem("oneSignalUserId")&&void 0!=localStorage.getItem("oneSignalUserId")&&$$.ajax({type:"POST",url:ENVYP_API_URL+"add_push_notification_id.php",data:"account_id="+localStorage.getItem("account_id")+"&push_id="+localStorage.getItem("oneSignalUserId"),dataType:"json",success:function(e,t,a){},error:function(e,t,a){}})}function clearLogInDetails(){$$("#txt-log-email-add").val(""),$$("#txt-log-email-pass").val(""),$$("#txt-email-add").val(""),$$("#txt-password").val(""),$$("#txt-repeat-password").val(""),$$("#txt-firstname").val(""),$$("#txt-lastname").val(""),$$("#txt-age").val(""),$$("#txt-description").val(""),imgfile=""}function clearTeamDetails(){$$("#txt-team-name").val(""),$$("#txt-team-description").val(""),$$("#txt-team-password").val(""),$$("#team-image").attr("src","img/envp-icon.png"),imgfile=""}function clearEditTeamDetails(){$$("#txt-team-edit-name").val(""),$$("#txt-team-edit-description").val(""),$$("#txt-team-edit-password").val(""),$$("#team-edit-image").attr("src","img/envp-icon.png"),imgfile=""}function clearRosterDetails(){$$("#txt-roster-name").val(""),$$("#txt-roster-position").val(""),$$("#roster-image").attr("src","img/profile.jpg"),imgfile=""}function clearEditRosterDetails(){$$("#edit-txt-roster-name").val(""),$$("#edit-txt-roster-position").val(""),$$("#edit-roster-image").attr("src","img/profile.jpg"),imgfile=""}function clearTournamentDetails(){$("#txt-tournament-date").val((new Date).toJSON().slice(0,16)),$$("#txt-opponent-name").val(""),$$("#txt-tournament-location").val(""),$$("#txt-tournament-description").val(""),$$("#tournament-image").attr("src","img/envp-icon-ldpi.png"),imgfile=""}function clearEditTournamentDetails(){$("#edit-txt-tournament-date").val((new Date).toJSON().slice(0,16)),$$("#edit-txt-opponent-name").val(""),$$("#edit-txt-tournament-location").val(""),$$("#edit-txt-tournament-description").val(""),$$("#edit-image-upload").attr("src","img/camera-flat.png"),imgfile=""}function validateEmail(e){var t=/^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,4}$/;return t.test(e)?!0:!1}function checkInternetConnection(){try{if(0==DEBUG){var e=navigator.connection.type;return"none"==e?!1:!0}return!0}catch(t){return!0}}function FBLogin(){if(1==checkInternetConnection())try{facebookConnectPlugin.login(["public_profile"],fbLoginSuccess,function(e){myApp.alert("[Facebook Error]: "+JSON.stringify(e))})}catch(e){myApp.alert("[Facebook Error]: "+e.message)}else myApp.alert(NO_INTERNET_ALERT)}function FBLogout(){facebookConnectPlugin.logout(function(e){})}function getFBDetails(){facebookConnectPlugin.api("me/?fields=id,last_name,first_name,email,birthday",["public_profile"],function(e){$$("#btn-email-login").attr("disabled",!0),$$("#btn-signup-page").attr("disabled",!0),$$.ajax({type:"POST",url:ENVYP_API_URL+"add_facebook_user.php",data:"facebook_id="+e.id,dataType:"json",success:function(t,a,i){if(localStorage.setItem("isFbLogin",1),1==t.status)localStorage.setItem("account_id",t.account_id),localStorage.setItem("email",t.email),localStorage.setItem("first_name",t.first_name),localStorage.setItem("last_name",t.last_name),localStorage.setItem("age",t.age),localStorage.setItem("description",t.description),localStorage.setItem("account_image",t.account_image),localStorage.setItem("currency_id",t.currency_id),localStorage.setItem("time_id",t.time_id),$("#div-profile-name").empty(),$$("#div-profile-name").prepend(localStorage.getItem("first_name")+" "+localStorage.getItem("last_name")),$$("#img-profile-image").attr("src",""==localStorage.getItem("account_image")||null==localStorage.getItem("account_image")?"img/profile.jpg":localStorage.getItem("account_image")),mainView.router.loadPage("choose_sports.html");else if(0==t.status){var n=calcAge(e.birthday),o="https://graph.facebook.com/"+e.id+"/picture?type=large";localStorage.setItem("fb_image",o),mainView.router.loadPage("profile_add.html?account_id="+t.account_id+"&first_name="+e.first_name+"&last_name="+e.last_name+"&age="+n+"&description=")}addPushNotificationID(),$$("#btn-email-login").removeAttr("disabled"),$$("#btn-signup-page").removeAttr("disabled")},error:function(e,t,a){myApp.alert("[ERROR] "+e.thrownError),$$("#btn-email-login").removeAttr("disabled"),$$("#btn-signup-page").removeAttr("disabled")}})},function(e){myApp.alert("[ERROR] "+e)})}function calcAge(e){var t=+new Date(e);return~~((Date.now()-t)/315576e5)}function onBackKeyDown(){try{if("choose-sports"==mainView.activePage.name||"main"==mainView.activePage.name)myApp.confirm("Do you want to Exit?","Exit App",function(){navigator.app.clearHistory(),navigator.app.exitApp()});else{if($$(".popup.popup-login").length>0)return!1;if($$(".popover, .actions-modal, .picker-modal").length>0)myApp.closeModal(".popover, .actions-modal, .picker-modal");else if($$(".searchbar.searchbar-active").length>0)$$(".searchbar.searchbar-active")[0].f7Searchbar.disable();else if($$(".photo-browser").length>0)$$(".photo-browser .photo-browser-close-link, .photo-browser .close-popup").trigger("click");else{myApp.closeModal();var e=myApp.getCurrentView();e.router.back()}}}catch(t){myApp.alert("back error: "+t.message)}}var myApp=new Framework7({modalTitle:"Envp",material:!0,preloadPreviousPage:!1,fastClicks:!0,pushState:!0}),$$=Dom7,mainView=myApp.addView(".view-main",{dynamicNavbar:!1});const ENVYP_API_URL="http://envp.dk/api/",NO_INTERNET_ALERT="Please check your internet connection",AJAX_ERROR_ALERT="Network error, please try again.",ERROR_ALERT="An error occured, please try again.",PUSHBOT_APP_ID="583d247f4a9efa72608b4567",PUSHBOT_SENDER_ID="280176703234";var imgfile="",latitude="",longitude="",edit_latitude="",edit_longitude="";document.addEventListener("deviceready",function(){window.plugins.OneSignal.startInit("536dcb4f-f5f0-4327-adb5-2f70746e20bf","280176703234").handleNotificationReceived(function(e){console.log("Did I receive a notification: "+JSON.stringify(e))}).handleNotificationOpened(function(e){console.log("didOpenRemoteNotificationCallBack: "+JSON.stringify(e))}).endInit(),window.plugins.OneSignal.getIds(function(e){localStorage.setItem("oneSignalUserId",e.userId),localStorage.setItem("oneSignalPushToken",e.pushToken),console.log("getIds: "+JSON.stringify(e))})},!1),document.addEventListener("backbutton",onBackKeyDown,!1),(""==localStorage.getItem("selectedLanguage")||null==localStorage.getItem("selectedLanguage"))&&localStorage.setItem("selectedLanguage","1"),(""==localStorage.getItem("currency_id")||null==localStorage.getItem("currency_id"))&&localStorage.setItem("currency_id","1"),(""==localStorage.getItem("time_id")||null==localStorage.getItem("time_id"))&&localStorage.setItem("time_id","1"),$(document).on({DOMNodeInserted:function(){$(".pac-item, .pac-item span",this).addClass("no-fastclick")}},".pac-container"),""!=localStorage.getItem("account_id")&&null!=localStorage.getItem("account_id")&&($$("#div-profile-name").prepend(localStorage.getItem("first_name")+" "+localStorage.getItem("last_name")),$$("#img-profile-image").attr("src",""==localStorage.getItem("account_image")||null==localStorage.getItem("account_image")?"img/profile.jpg":localStorage.getItem("account_image")),mainView.router.loadPage("choose_sports.html")),"1"==localStorage.getItem("selectedLanguage")?($("#lbl-profile").empty(),$("#lbl-profile").prepend("Profile"),$("#btn-my-teams").empty(),$("#btn-my-teams").prepend("My Teams"),$("#btn-edit-profile").empty(),$("#btn-edit-profile").prepend("Edit Profile"),$("#btn-inbox").empty(),$("#btn-inbox").prepend("Inbox"),$("#btn-choose-language").empty(),$("#btn-choose-language").prepend("Language"),$("#btn-settings").empty(),$("#btn-settings").prepend("Settings"),$("#btn-logout").empty(),$("#btn-logout").prepend("Logout"),$("#lbl-team-settings").empty(),$("#lbl-team-settings").prepend("Settings"),$("#lbl-team-participants").empty(),$("#lbl-team-participants").prepend("Participants"),$("#lbl-team-administrators").empty(),$("#lbl-team-administrators").prepend("Administrators")):($("#lbl-profile").empty(),$("#lbl-profile").prepend("Profil"),$("#btn-my-teams").empty(),$("#btn-my-teams").prepend("Mine Teams"),$("#btn-edit-profile").empty(),$("#btn-edit-profile").prepend("Rediger profil"),$("#btn-inbox").empty(),$("#btn-inbox").prepend("Indbakke"),$("#btn-choose-language").empty(),$("#btn-choose-language").prepend("Sprog"),$("#btn-settings").empty(),$("#btn-settings").prepend("Settings"),$("#btn-logout").empty(),$("#btn-logout").prepend("Log ud"),$("#lbl-team-settings").empty(),$("#lbl-team-settings").prepend("Indstillinger"),$("#lbl-team-participants").empty(),$("#lbl-team-participants").prepend("Deltagere"),$("#lbl-team-administrators").empty(),$("#lbl-team-administrators").prepend("Administratorer")),$$("#btn-email-login").on("click",function(){if(1==checkInternetConnection()){$$("#btn-email-login").attr("disabled",!0),$$("#btn-signup-page").attr("disabled",!0);var e=$$("#txt-log-email-add").val(),t=$$("#txt-log-email-pass").val();""==e||""==t?(myApp.alert("Username or Password cannot be empty"),$$("#btn-email-login").removeAttr("disabled"),$$("#btn-signup-page").removeAttr("disabled")):(myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"login.php",data:"account="+e+"&password="+t,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),"0"==e.status?(localStorage.setItem("isFbLogin",0),localStorage.setItem("account_id",e.account_id),localStorage.setItem("email",e.email),localStorage.setItem("first_name",e.first_name),localStorage.setItem("last_name",e.last_name),localStorage.setItem("age",e.age),localStorage.setItem("description",e.description),localStorage.setItem("account_image",e.account_image),localStorage.setItem("currency_id",e.account_image),localStorage.setItem("currency_id",e.currency_id),localStorage.setItem("time_id",e.time_id),$$("#div-profile-name").prepend(localStorage.getItem("first_name")+" "+localStorage.getItem("last_name")),$$("#img-profile-image").attr("src",""==localStorage.getItem("account_image")||null==localStorage.getItem("account_image")?"img/profile.jpg":localStorage.getItem("account_image")),addPushNotificationID(),mainView.router.loadPage("choose_sports.html")):myApp.alert(e.message),$$("#btn-email-login").removeAttr("disabled"),$$("#btn-signup-page").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-email-login").removeAttr("disabled"),$$("#btn-signup-page").removeAttr("disabled");
}}))}else myApp.alert(NO_INTERNET_ALERT)}),$$("#btn-signup-page").on("click",function(){mainView.router.loadPage("signup.html")}),$$("#btn-logout").on("click",function(){myApp.closePanel("left"),localStorage.setItem("account_id",""),$("#div-profile-name").empty(),$("#img-profile-image").empty(),1==localStorage.getItem("isFbLogin")&&FBLogout(),mainView.router.loadPage("main.html")}),$$("#btn-edit-profile").on("click",function(){myApp.closePanel("left"),mainView.router.loadPage("profile_add.html?account_id="+localStorage.getItem("account_id")+"&first_name="+localStorage.getItem("first_name")+"&last_name="+localStorage.getItem("last_name")+"&age="+localStorage.getItem("age")+"&description="+localStorage.getItem("description")+"&image_url="+localStorage.getItem("account_image"))}),$$("#btn-forgot-pass").on("click",function(){myApp.prompt("Please enter your email",function(e){return 0==validateEmail(e)?(myApp.alert("Invalid email format"),!1):void $$.ajax({type:"POST",url:ENVYP_API_URL+"send_password.php",data:"email="+e,dataType:"json",success:function(e,t,a){myApp.alert(e.status)},error:function(e,t,a){myApp.alert("An error occured, please try again.")}})})}),myApp.onPageInit("main",function(e){$$("#btn-email-login").on("click",function(){if(1==checkInternetConnection()){$$("#btn-email-login").attr("disabled",!0),$$("#btn-signup-page").attr("disabled",!0);var e=$$("#txt-log-email-add").val(),t=$$("#txt-log-email-pass").val();""==e||""==t?(myApp.alert("Username or Password cannot be empty"),$$("#btn-email-login").removeAttr("disabled"),$$("#btn-signup-page").removeAttr("disabled")):(myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"login.php",data:"account="+e+"&password="+t,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),"0"==e.status?(localStorage.setItem("isFbLogin",0),localStorage.setItem("account_id",e.account_id),localStorage.setItem("email",e.email),localStorage.setItem("first_name",e.first_name),localStorage.setItem("last_name",e.last_name),localStorage.setItem("age",e.age),localStorage.setItem("description",e.description),localStorage.setItem("account_image",e.account_image),localStorage.setItem("currency_id",e.currency_id),localStorage.setItem("time_id",e.time_id),$$("#div-profile-name").prepend(localStorage.getItem("first_name")+" "+localStorage.getItem("last_name")),$$("#img-profile-image").attr("src",""==localStorage.getItem("account_image")||null==localStorage.getItem("account_image")?"img/profile.jpg":localStorage.getItem("account_image")),addPushNotificationID(),mainView.router.loadPage("choose_sports.html")):myApp.alert(e.message),$$("#btn-email-login").removeAttr("disabled"),$$("#btn-signup-page").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-email-login").removeAttr("disabled"),$$("#btn-signup-page").removeAttr("disabled")}}))}else myApp.alert(NO_INTERNET_ALERT)}),$$("#btn-signup-page").on("click",function(){mainView.router.loadPage("signup.html")}),$$("#btn-forgot-pass").on("click",function(){myApp.prompt("Please enter your email",function(e){return 0==validateEmail(e)?(myApp.alert("Invalid email format"),!1):void $$.ajax({type:"POST",url:ENVYP_API_URL+"send_password.php",data:"email="+e,dataType:"json",success:function(e,t,a){myApp.alert(e.status)},error:function(e,t,a){myApp.alert("An error occured, please try again.")}})})})}),myApp.onPageInit("signup",function(e){$$("#btn-signup").on("click",function(){if(1==checkInternetConnection()){$$("#btn-signup").attr("disabled",!0);var e=$$("#txt-email-add").val(),t=$$("#txt-password").val(),a=$$("#txt-repeat-password").val();if(""==e)return myApp.alert("Please enter email!"),$$("#btn-signup").removeAttr("disabled"),!1;if(0==validateEmail(e))return myApp.alert("Please enter valid email!"),$$("#btn-signup").removeAttr("disabled"),!1;if(""==t)return myApp.alert("Please enter password!"),$$("#btn-signup").removeAttr("disabled"),!1;if(""==a)return myApp.alert("Please repeat the password!"),$$("#btn-signup").removeAttr("disabled"),!1;if(t!=a)return myApp.alert("Password is not the same!"),$$("#btn-signup").removeAttr("disabled"),!1;if(t.length<6)return myApp.alert("min 6 characters, max 50 characters"),$$("#btn-signup").removeAttr("disabled"),!1;if(t.length>50)return myApp.alert("min 6 characters, max 50 characters"),$$("#btn-signup").removeAttr("disabled"),!1;if(-1==t.search(/\d/))return myApp.alert("must contain at least 1 number"),$$("#btn-signup").removeAttr("disabled"),!1;if(-1==t.search(/[a-zA-Z]/))return myApp.alert("must contain at least 1 letter"),$$("#btn-signup").removeAttr("disabled"),!1;if(-1!=t.search(/[^a-zA-Z0-9\!\@\#\$\%\^\&\*\(\)\_\+\.\,\;\:]/))return myApp.alert("character ivalid"),$$("#btn-signup").removeAttr("disabled"),!1;if(0==$("#chkbox-terms").is(":checked"))return myApp.alert("Please agree with the terms and conditions"),$$("#btn-signup").removeAttr("disabled"),!1;myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"add_user.php",data:"account="+e+"&password="+t+"&account_type=1",dataType:"json",success:function(e,t,a){myApp.hideIndicator(),"0"==e.status?(localStorage.setItem("account_id",e.account_id),localStorage.setItem("isFbLogin",0),addPushNotificationID(),mainView.router.loadPage("profile_add.html")):($$("#txt-password").val(""),$$("#txt-repeat-password").val("")),myApp.alert(e.message),$$("#btn-signup").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-signup").removeAttr("disabled")}})}else myApp.alert(NO_INTERNET_ALERT)}),$$("#btn-terms").on("click",function(){myApp.popup(".popup-terms")}),$$("#btn-close-terms").on("click",function(){myApp.closeModal(".popup-terms")})}),myApp.onPageInit("inbox-list",function(e){if(myApp.closePanel("left"),"1"==localStorage.getItem("selectedLanguage")?$("#lbl-inbox-list").prepend("Inbox"):$("#lbl-inbox-list").prepend("Indbakke"),1==checkInternetConnection()){myApp.showIndicator();var t=[];$.getJSON(ENVYP_API_URL+"get_inbox_list.php?account_id="+localStorage.getItem("account_id"),function(a){$.each(a,function(e,a){"empty"==a.status?myApp.alert("No message yet :("):($title=0==a.status?"<b>"+a.title+"</b>":a.title,$message=0==a.status?"<b>"+a.message+"</b>":a.message,t.push({inbox_id:a.inbox_id,account_image:a.account_image,title:$title,message:$message,status:a.status}))});myApp.virtualList($$(e.container).find(".virtual-list"),{items:t,searchAll:function(e,t){for(var a=[],i=0;i<t.length;i++)(t[i].title.indexOf(e)>=0||""===e.trim())&&a.push(i);return a},template:'<li><a href="inbox_detail.html?inbox_id={{inbox_id}}&status={{status}}" class="item-link item-content"><div class="item-media"><img data-src="{{account_image}}" class="lazy lazy-fadein img-circle" style="width:44px; height:44px;"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">{{title}}</div></div><div class="item-subtitle">{{message}}</div></div></a></li>',height:73});myApp.initImagesLazyLoad(e.container),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}else myApp.alert(NO_INTERNET_ALERT);$$("#btn-inbox-refresh").on("click",function(){mainView.router.reloadPage("inbox.html")})}),myApp.onPageInit("inbox-detail",function(e){myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_inbox_detail.php?inbox_id="+e.query.inbox_id+"&status="+e.query.status,function(e){$.each(e,function(e,t){$$("#img-inbox-image").attr("src",""==t.account_image||null==t.account_image?"img/profile.jpg":t.account_image),$("#div-inbox-title").prepend(t.title),$("#div-inbox-creator").prepend("From: "+t.account_name),$("#p-inbox-message").prepend(t.message)}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}),myApp.onPageInit("settings",function(e){myApp.closePanel("left"),"1"==localStorage.getItem("selectedLanguage")?($("#lbl-settings").prepend("Settings"),$("#btn-update-settings").prepend("Update")):($("#lbl-settings").prepend("Indstillinger"),$("#btn-update-settings").prepend("Opdatering")),1==localStorage.getItem("currency_id")?(myApp.smartSelectAddOption("#select-currency-list",'<option value="1" selected>USD</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="2">DKK</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="3">GBP</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="4">EUR</option>'),$$("#select-currency-list").val(1)):2==localStorage.getItem("currency_id")?(myApp.smartSelectAddOption("#select-currency-list",'<option value="1">USD</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="2" selected>DKK</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="3">GBP</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="4">EUR</option>'),$$("#select-currency-list").val(2)):3==localStorage.getItem("currency_id")?(myApp.smartSelectAddOption("#select-currency-list",'<option value="1">USD</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="2">DKK</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="3" selected>GBP</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="4">EUR</option>'),$$("#select-currency-list").val(3)):4==localStorage.getItem("currency_id")&&(myApp.smartSelectAddOption("#select-currency-list",'<option value="1">USD</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="2">DKK</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="3">GBP</option>'),myApp.smartSelectAddOption("#select-currency-list",'<option value="4" selected>EUR</option>'),$$("#select-currency-list").val(4)),1==localStorage.getItem("time_id")?(myApp.smartSelectAddOption("#select-time-list",'<option value="1" selected>24-Hour Clock</option>'),myApp.smartSelectAddOption("#select-time-list",'<option value="2">12-Hour Clock</option>'),$$("#select-time-list").val("1")):2==localStorage.getItem("time_id")&&(myApp.smartSelectAddOption("#select-time-list",'<option value="1">24-Hour Clock</option>'),myApp.smartSelectAddOption("#select-time-list",'<option value="2" selected>12-Hour Clock</option>'),$$("#select-time-list").val("2")),$$("#btn-update-settings").on("click",function(){if(1==checkInternetConnection()){var e=$$("#select-currency-list").val(),t=$$("#select-time-list").val();$$("#btn-update-settings").attr("disabled",!0),myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"update_settings.php",data:"account_id="+localStorage.getItem("account_id")+"&currency_id="+e+"&time_id="+t,dataType:"json",success:function(a,i,n){myApp.hideIndicator(),"0"==a.status?(myApp.alert("Success"),localStorage.setItem("currency_id",e),localStorage.setItem("time_id",t)):myApp.alert(a.message),$$("#btn-update-settings").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-update-settings").removeAttr("disabled")}})}else myApp.alert(NO_INTERNET_ALERT)})}),myApp.onPageInit("profile-add",function(e){var t="";void 0!=e.query.account_id&&($$("#txt-firstname").val(e.query.first_name),$$("#txt-lastname").val(e.query.last_name),$$("#txt-age").val(e.query.age),$$("#txt-description").val(e.query.description),1==localStorage.getItem("isFbLogin")?(t=localStorage.getItem("fb_image"),$$("#profile-image").attr("src",t)):(t=e.query.image_url,$$("#profile-image").attr("src",""==t||null==t?"img/profile.jpg":t)),localStorage.setItem("account_id",e.query.account_id)),$$("#btn-continue").on("click",function(){if(1==checkInternetConnection()){$$("#btn-continue").attr("disabled",!0);var e=$$("#txt-firstname").val(),a=$$("#txt-lastname").val(),i=$$("#txt-age").val(),n=$$("#txt-description").val();if(""==e||null==e)return myApp.alert("Please enter first name!"),$$("#btn-continue").removeAttr("disabled"),!1;if(""==a||null==a)return myApp.alert("Please enter last name!"),$$("#btn-continue").removeAttr("disabled"),!1;if(""==i||0==i)return myApp.alert("Please enter age!"),$$("#btn-continue").removeAttr("disabled"),!1;if(""==imgfile)myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"update_user.php",data:"account_id="+localStorage.getItem("account_id")+"&first_name="+e+"&last_name="+a+"&age="+i+"&description="+n+"&image_url="+(void 0==t?"":t),dataType:"json",success:function(e,t,a){myApp.hideIndicator(),"0"==e.status?(myApp.alert("Success"),clearLogInDetails(),localStorage.setItem("account_image",e.account_image),mainView.router.loadPage("choose_sports.html")):myApp.alert(e.message),$$("#btn-continue").removeAttr("disabled"),imgfile=""},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-continue").removeAttr("disabled")}});else{myApp.showIndicator();var o=new FileUploadOptions;o.fileKey="file",o.fileName=imgfile.substr(imgfile.lastIndexOf("/")+1),o.mimeType="image/jpeg",o.chunkedMode=!1;var r=new Object;r.account_id=localStorage.getItem("account_id"),r.first_name=e,r.last_name=a,r.age=i,r.description=n,o.params=r;var l=new FileTransfer;l.upload(imgfile,ENVYP_API_URL+"update_user.php",winUpdateUser,fail,o),clearLogInDetails(),myApp.hideIndicator(),mainView.router.loadPage("choose_sports.html"),$$("#btn-continue").removeAttr("disabled"),imgfile=""}localStorage.setItem("first_name",e),localStorage.setItem("last_name",a),localStorage.setItem("age",i),localStorage.setItem("description",n),$("#div-profile-name").empty(),$("#img-profile-image").empty(),$$("#div-profile-name").prepend(localStorage.getItem("first_name")+" "+localStorage.getItem("last_name")),$$("#img-profile-image").attr("src",""==localStorage.getItem("account_image")||null==localStorage.getItem("account_image")?"img/profile.jpg":localStorage.getItem("account_image"))}else myApp.alert(NO_INTERNET_ALERT)})}),myApp.onPageInit("choose-sports",function(e){$("#div-inbox-badge").empty(),"1"==localStorage.getItem("selectedLanguage")?$("#lbl-choose-sports").prepend("Choose Sports"):$("#lbl-choose-sports").prepend("V챈lg Sport"),$$("#open-left-panel").on("click",function(e){myApp.openPanel("left")}),$$("#close-left-panel").on("click",function(){myApp.closePanel("left")}),$$.ajax({type:"POST",url:ENVYP_API_URL+"get_inbox_count.php",data:"account_id="+localStorage.getItem("account_id"),dataType:"json",success:function(e,t,a){e.inbox_count>0&&$("#div-inbox-badge").prepend('<span class="badge bg-red">'+e.inbox_count+"</span>")},error:function(e,t,a){}})}),myApp.onPageInit("home",function(e){"1"==localStorage.getItem("selectedLanguage")?($("#lbl-home").prepend("Home"),$("#btn-make-new-team").prepend("Make New Team"),$("#btn-choose-existing").prepend("Choose Existing")):($("#lbl-home").prepend("Hjem"),$("#btn-make-new-team").prepend("opret nyt nye hold"),$("#btn-choose-existing").prepend("V챈lg eksisterende")),null!=e.query.sport_id&&(localStorage.setItem("selectedSportID",e.query.sport_id),localStorage.setItem("selectedSportImage",e.query.image_url)),$$("#img-sport-selected").attr("src",localStorage.getItem("selectedSportImage"))}),myApp.onPageInit("team-add",function(e){"1"==localStorage.getItem("selectedLanguage")?($("#lbl-create-team").prepend("Create Team"),$("#lbl-team-add-upload-image").prepend("Upload Image"),$("#lbl-team-add-details").prepend("Details"),$("#lbl-team-name").prepend("Team name"),$("#lbl-team-description").prepend("Description"),$("#lbl-team-password").prepend("Password"),$("#btn-add-team").prepend("Continue")):($("#lbl-create-team").prepend("Opret Team"),$("#lbl-team-add-upload-image").prepend("Upload billede"),$("#lbl-team-add-details").prepend("Detaljer"),$("#lbl-team-name").prepend("Hold navn"),$("#lbl-team-description").prepend("Beskrivelse"),$("#lbl-team-password").prepend("Adgangskode"),$("#btn-add-team").prepend("tilf첩j")),$$("#btn-add-team").on("click",function(){if(1==checkInternetConnection()){$$("#btn-add-team").attr("disabled",!0);var e=$$("#txt-team-name").val(),t=$$("#txt-team-description").val(),a=$$("#txt-team-password").val();if(""==e||null==e)return myApp.alert("Please enter team name!"),$$("#btn-add-team").removeAttr("disabled"),!1;if(""==a||null==a)return myApp.alert("Please enter team password!"),$$("#btn-add-team").removeAttr("disabled"),!1;if(""==imgfile)myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"add_team.php",data:"account_id="+localStorage.getItem("account_id")+"&sport_id="+localStorage.getItem("selectedSportID")+"&team_name="+e+"&team_description="+t+"&team_password="+a,dataType:"json",success:function(t,i,n){myApp.hideIndicator(),"0"==t.status&&(clearTeamDetails(),mainView.router.loadPage("team_management.html?team_id="+t.team_id+"&team_name="+e+"&team_password="+a)),myApp.alert(t.message),$$("#btn-add-team").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-add-team").removeAttr("disabled")}});else{myApp.showIndicator();var i=new FileUploadOptions;i.fileKey="file",i.fileName=imgfile.substr(imgfile.lastIndexOf("/")+1),i.mimeType="image/jpeg",i.chunkedMode=!1;var n=new Object;n.account_id=localStorage.getItem("account_id"),n.sport_id=localStorage.getItem("selectedSportID"),n.team_name=e,n.team_description=t,n.team_password=a,i.params=n;var o=new FileTransfer;o.upload(imgfile,ENVYP_API_URL+"add_team.php",winTeamAdd,fail,i),clearTeamDetails(),myApp.hideIndicator(),$$("#btn-add-team").removeAttr("disabled")}}})}),myApp.onPageInit("team-edit",function(e){"1"==localStorage.getItem("selectedLanguage")?($("#lbl-edit-team").prepend("Edit Team"),$("#lbl-team-edit-upload-image").prepend("Upload Image"),$("#lbl-team-edit-details").prepend("Details"),$("#lbl-team-edit-name").prepend("Team name"),$("#lbl-team-edit-description").prepend("Description"),$("#lbl-team-edit-password").prepend("Password"),$("#btn-edit-team").prepend("Continue")):($("#lbl-edit-team").prepend("Edit Team"),$("#lbl-team-edit-upload-image").prepend("Upload billede"),$("#lbl-team-edit-details").prepend("Detaljer"),$("#lbl-team-edit-name").prepend("Hold navn"),$("#lbl-team-edit-description").prepend("Beskrivelse"),$("#lbl-team-edit-password").prepend("Adgangskode"),$("#btn-edit-team").prepend("tilf첩j")),myApp.showIndicator();var t="";$.getJSON(ENVYP_API_URL+"get_team_detail.php?team_id="+localStorage.getItem("selectedTeamID"),function(e){$.each(e,function(e,a){t=a.image_url,""!=t&&$("#team-edit-image").attr("src",t),$("#txt-team-edit-name").attr("value",a.name),$("#txt-team-edit-password").attr("value",a.password),$("#txt-team-edit-description").prepend(a.description)}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$$("#btn-edit-team").on("click",function(){if(1==checkInternetConnection()){$$("#btn-edit-team").attr("disabled",!0);var e=$$("#txt-team-edit-name").val(),a=$$("#txt-team-edit-description").val(),i=$$("#txt-team-edit-password").val();if(""==e||null==e)return myApp.alert("Please enter team name!"),$$("#btn-edit-team").removeAttr("disabled"),!1;if(""==i||null==i)return myApp.alert("Please enter team password!"),$$("#btn-edit-team").removeAttr("disabled"),!1;if(""==imgfile)myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"update_team.php",data:"account_id="+localStorage.getItem("account_id")+"&team_id="+localStorage.getItem("selectedTeamID")+"&team_name="+e+"&team_description="+a+"&team_password="+i+"&team_image="+t,dataType:"json",success:function(t,a,n){myApp.hideIndicator(),"0"==t.status&&(clearEditTeamDetails(),mainView.router.loadPage("team_management.html?team_id="+localStorage.getItem("selectedTeamID")+"&team_name="+e+"&team_password="+i)),myApp.alert(t.message),$$("#btn-edit-team").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-edit-team").removeAttr("disabled")}});else{myApp.showIndicator();var n=new FileUploadOptions;n.fileKey="file",n.fileName=imgfile.substr(imgfile.lastIndexOf("/")+1),n.mimeType="image/jpeg",n.chunkedMode=!1;var o=new Object;o.account_id=localStorage.getItem("account_id"),o.team_id=localStorage.getItem("selectedTeamID"),o.team_name=e,o.team_description=a,o.team_password=i,o.team_image=t,n.params=o;var r=new FileTransfer;r.upload(imgfile,ENVYP_API_URL+"update_team.php",winTeamAdd,fail,n),clearEditTeamDetails(),myApp.hideIndicator(),$$("#btn-add-team").removeAttr("disabled")}}})}),myApp.onPageInit("team-list",function(e){if("1"==localStorage.getItem("selectedLanguage")?$("#lbl-team-list").prepend("Team List"):$("#lbl-team-list").prepend("Team liste"),1==checkInternetConnection()){myApp.showIndicator();var t=[];$.getJSON(ENVYP_API_URL+"get_team_list.php?sport_id="+localStorage.getItem("selectedSportID"),function(a){$.each(a,function(e,a){"empty"==a.status?myApp.alert("No teams yet :("):t.push({team_id:a.team_id,team_admin:a.team_admin,team_name:a.team_name,team_password:a.team_password,team_image:""==a.team_image||null==a.team_image?"img/envp-icon-ldpi.png":a.team_image,created_by:a.first_name+" "+a.last_name})});myApp.virtualList($$(e.container).find(".virtual-list"),{items:t,searchAll:function(e,t){for(var a=[],i=0;i<t.length;i++)(t[i].team_name.indexOf(e)>=0||""===e.trim())&&a.push(i);return a},template:'<li><a href="#" onclick="getTeamPassword({{team_id}},{{team_admin}},\'{{team_name}}\',\'{{team_password}}\',\'{{team_image}}\',2)" class="item-link item-content"><div class="item-media"><img data-src="{{team_image}}" class="lazy lazy-fadein img-circle" style="width:44px; height:44px;"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">{{team_name}}</div></div><div class="item-subtitle">Administrator: {{created_by}}</div></div></a></li>',height:73});myApp.initImagesLazyLoad(e.container),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}else myApp.alert(NO_INTERNET_ALERT);$$("#btn-team-list-refresh").on("click",function(){mainView.router.reloadPage("team_list.html")})}),myApp.onPageInit("my-team-list",function(e){if(myApp.closePanel("left"),"1"==localStorage.getItem("selectedLanguage")?$("#lbl-my-team-list").prepend("My Team List"):$("#lbl-my-team-list").prepend("Mine Team liste"),1==checkInternetConnection()){myApp.showIndicator();var t=[];$.getJSON(ENVYP_API_URL+"get_my_team_list.php?account_id="+localStorage.getItem("account_id"),function(a){$.each(a,function(e,a){"empty"==a.status?myApp.alert("No teams yet :("):t.push({team_id:a.team_id,team_admin:a.team_admin,team_name:a.team_name,team_password:a.team_password,team_image:a.team_image,created_by:a.first_name+" "+a.last_name})});myApp.virtualList($$(e.container).find(".virtual-list"),{items:t,searchAll:function(e,t){for(var a=[],i=0;i<t.length;i++)(t[i].team_name.indexOf(e)>=0||""===e.trim())&&a.push(i);return a},template:'<li><a href="#" onclick="getTeamPassword({{team_id}},{{team_admin}},\'{{team_name}}\',\'{{team_password}}\',\'{{team_image}}\',1)" class="item-link item-content"><div class="item-media"><img data-src="{{team_image}}" class="lazy lazy-fadein img-circle" style="width:44px; height:44px;"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">{{team_name}}</div></div><div class="item-subtitle">Administrator: {{created_by}}</div></div></a></li>',height:73});myApp.initImagesLazyLoad(e.container),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}else myApp.alert(NO_INTERNET_ALERT);$$("#btn-my-team-list-refresh").on("click",function(){mainView.router.reloadPage("my_team_list.html")})}),myApp.onPageInit("team-stats",function(e){"1"==localStorage.getItem("selectedLanguage")?$("#lbl-team-stats").prepend("Team Statistics"):$("#lbl-team-stats").prepend("Team statistik"),3==localStorage.getItem("selectedSportID")||4==localStorage.getItem("selectedSportID")?($("#li-team-stats-fouls").hide(),$("#lbl-team-games").append("games"),$("#lbl-team-stats-opp-points").append("opponent goals/m책l"),$("#lbl-team-stats-points").append("goals/m책l"),$("#lbl-team-stats-assists").append("assists"),$("#lbl-team-stats-yellowcard").append("yellow card"),$("#lbl-team-stats-redcard").append("red card")):2==localStorage.getItem("selectedSportID")||5==localStorage.getItem("selectedSportID")?($("#li-team-stats-yellowcard").hide(),$("#li-team-stats-redcard").hide(),$("#lbl-team-games").append("games"),$("#lbl-team-stats-opp-points").append("opponent goals/m책l"),$("#lbl-team-stats-points").append("goals/m책l"),$("#lbl-team-stats-assists").append("assists"),$("#lbl-team-stats-fouls").append("fouls/minutes")):(1==localStorage.getItem("selectedSportID")||6==localStorage.getItem("selectedSportID"))&&($("#li-team-stats-yellowcard").hide(),$("#li-team-stats-redcard").hide(),$("#lbl-team-games").append("games"),$("#lbl-team-stats-opp-points").append("opponent points"),$("#lbl-team-stats-points").append("points"),$("#lbl-team-stats-assists").append("assists"),$("#lbl-team-stats-fouls").append("fouls")),$("#li-team-stats-assists").hide();var t=0,a=0,i=0,n=0,o=0,r=0;$$("#img-team-image").attr("data-src",""==localStorage.getItem("selectedTeamImage")||null==localStorage.getItem("selectedTeamImage")?"img/profile.jpg":localStorage.getItem("selectedTeamImage")),$$("#img-team-image").addClass("lazy lazy-fadein"),myApp.initImagesLazyLoad(e.container),$$("#p-team-name").prepend(localStorage.getItem("selectedTeamName")),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_team_stats.php?team_id="+localStorage.getItem("selectedTeamID"),function(e){$.each(e,function(e,l){total_games=l.total_games,t=l.ppg,a=l.oppg,i=l.apg,n=l.fpg,o=l.yellowcard,r=l.redcard}),$("#team-games").prepend(total_games),$("#team-ppg").prepend(t),$("#team-oppg").prepend(a),$("#team-apg").prepend(i),$("#team-fpg").prepend(n),$("#team-yellowcard").prepend(o),$("#team-redcard").prepend(r),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}),myApp.onPageInit("team-management",function(e){"1"==localStorage.getItem("selectedLanguage")?($("#btn-roster").append("Roster"),$("#btn-tournament").append("Tournament"),$("#btn-statistics").append("Statistics"),$("#btn-fines").append("Fines")):($("#btn-roster").append("mandskab"),$("#btn-tournament").append("Turnering"),$("#btn-statistics").append("Statistik"),$("#btn-fines").append("B첩der")),null!=e.query.team_id&&(localStorage.setItem("selectedTeamName",e.query.team_name),localStorage.setItem("selectedTeamID",e.query.team_id),localStorage.setItem("selectedTeamName",e.query.team_name),localStorage.setItem("selectedTeamImage",e.query.team_image),localStorage.setItem("selectedTeamPassword",e.query.team_password),localStorage.setItem("currentTeamAdmin",e.query.team_admin)),localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")&&$("#btn-edit-team-detail").hide(),$("#header-team-name").append(localStorage.getItem("selectedTeamName")),$$("#btn-roster").on("click",function(){mainView.router.loadPage("roster_list.html")}),$$("#btn-tournament").on("click",function(){mainView.router.loadPage("tournament_list.html")}),$$("#open-right-panel").on("click",function(e){getParticipantList(),getTeamAdministratorList(),myApp.openPanel("right")}),$$("#close-right-panel").on("click",function(){myApp.closePanel("right")}),$$("#btn-team-manage-back").on("click",function(){1==localStorage.getItem("backTournament")?mainView.router.loadPage("my_team_list.html"):2==localStorage.getItem("backTournament")&&mainView.router.loadPage("team_list.html")})}),myApp.onPageInit("fines-list",function(e){if("1"==localStorage.getItem("selectedLanguage")?$("#lbl-fines-list").append("Fines List"):$("#lbl-fines-list").append("fines liste"),1==checkInternetConnection()){var t=[];myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_roster_fines.php?team_id="+localStorage.getItem("selectedTeamID")+"&currency_id="+localStorage.getItem("currency_id"),function(a){$.each(a,function(e,a){if("empty"==a.status)myApp.alert("No roster fines yet :(");else{var i=""==a.image_url||null==a.image_url?"img/profile.jpg":a.image_url;t.push({roster_id:a.roster_id,roster_name:a.name,roster_image:i,roster_position:a.position,total_price:a.total_price})}});myApp.virtualList($$(e.container).find(".virtual-list"),{items:t,searchAll:function(e,t){for(var a=[],i=0;i<t.length;i++)(t[i].roster_name.indexOf(e)>=0||""===e.trim())&&a.push(i);return a},template:'<li><a href="fine_detail_list.html?roster_id={{roster_id}}" class="item-link item-content"><div class="item-media"><img data-src="{{roster_image}}" class="lazy lazy-fadein img-circle" style="width:44px; height:44px;"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">{{roster_name}}</div><div class="item-after">{{total_price}}</div></div><div class="item-subtitle">{{roster_position}}</div><div class="item-text"></div></div></a></li>',height:73});myApp.initImagesLazyLoad(e.container),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}else myApp.alert(NO_INTERNET_ALERT);$$("#btn-fines-list-refresh").on("click",function(){mainView.router.reloadPage("fines_list.html")})}),myApp.onPageInit("fine-detail-list",function(e){if("1"==localStorage.getItem("selectedLanguage")?$("#lbl-fine-details-list").append("Fines Detail List"):$("#lbl-fines-details-list").append("fines Detalje liste"),1==checkInternetConnection()){var t=[];myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_roster_fine_details_list.php?roster_id="+e.query.roster_id,function(a){$.each(a,function(e,a){if("empty"==a.status)myApp.alert("No roster fines yet :(");else{var i=""==a.image_url||null==a.image_url?"img/profile.jpg":a.image_url;t.push({tournament_image:i,opponent:a.opponent,fine:a.fine,date:a.date,price:a.price})}});myApp.virtualList($$(e.container).find(".virtual-list"),{items:t,searchAll:function(e,t){for(var a=[],i=0;i<t.length;i++)(t[i].opponent.indexOf(e)>=0||""===e.trim())&&a.push(i);return a},template:'<li class="item-content"><div class="item-media"><img data-src="{{tournament_image}}" class="lazy lazy-fadein img-circle" style="width:44px; height:44px;"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">{{opponent}}</div><div class="item-after">{{price}}</div></div><div class="item-subtitle">{{date}}</div><div class="item-text">{{fine}}</div></div></li>',height:function(e){return e.fine,93}});myApp.initImagesLazyLoad(e.container),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}else myApp.alert(NO_INTERNET_ALERT);$$("#btn-fines-detail-list-refresh").on("click",function(){mainView.router.reloadPage("fine_detail_list.html?roster_id="+e.query.roster_id)})}),myApp.onPageInit("roster-list",function(e){if("1"==localStorage.getItem("selectedLanguage")?($("#lbl-roster-list").empty(),$("#lbl-roster-list").append("Roster List")):($("#lbl-roster-list").empty(),$("#lbl-roster-list").append("mandskab liste")),localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")&&$("#btn-show-add-roster").hide(),1==checkInternetConnection()){var t=[];myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_roster_list.php?team_id="+localStorage.getItem("selectedTeamID"),function(a){$.each(a,function(e,a){if("empty"==a.status)myApp.alert("No roster yet :(");else{var i=""==a.image_url||null==a.image_url?"img/profile.jpg":a.image_url;t.push({roster_id:a.roster_id,roster_name:a.name,roster_image:i,roster_position:a.position})}});myApp.virtualList($$(e.container).find(".virtual-list"),{items:t,searchAll:function(e,t){for(var a=[],i=0;i<t.length;i++)(t[i].roster_name.indexOf(e)>=0||""===e.trim())&&a.push(i);return a},template:'<li class="swipeout demo-remove-callback"><a href="roster_detail.html?roster_id={{roster_id}}&roster_name={{roster_name}}&roster_position={{roster_position}}&roster_image={{roster_image}}" class="item-link item-content swipeout-content"><div class="item-media"><img data-src="{{roster_image}}" class="lazy lazy-fadein img-circle" style="width:44px; height:44px;"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">{{roster_name}}</div><div class="item-after"></div></div><div class="item-subtitle">{{roster_position}}</div><div class="item-text"></div></div></a><div class="swipeout-actions-left"><a href="#" onClick="deleteRoster({{roster_id}})" data-confirm="Are you sure you want to delete? All votes and fines will be lost once you remove this roster." class="swipeout-delete">Delete</a></div></li>',
height:73});myApp.initImagesLazyLoad(e.container),myApp.hideIndicator(),localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")&&$("li").removeClass("swipeout"),$$(".demo-remove-callback").on("deleted",function(){$$.ajax({type:"POST",url:ENVYP_API_URL+"delete_roster.php",data:"roster_id="+localStorage.getItem("selectedRosterID"),dataType:"json",success:function(e,t,a){},error:function(e,t,a){}})})}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}else myApp.alert(NO_INTERNET_ALERT);$$("#btn-roster-list-refresh").on("click",function(){mainView.router.reloadPage("roster_list.html")})}),myApp.onPageInit("roster-add",function(e){"1"==localStorage.getItem("selectedLanguage")?($("#lbl-add-roster").append("Add Roster"),$("#lbl-roster-add-image").append("Image"),$("#lbl-roster-add-name").append("Roster name"),$("#lbl-roster-add-position").append("Position"),$("#btn-add-roster").append("Continue")):($("#lbl-add-roster").append("tilf첩j spiller"),$("#lbl-roster-add-image").append("Billede"),$("#lbl-roster-add-name").append("mandskab navn"),$("#lbl-roster-add-position").append("Position"),$("#btn-add-roster").append("tilf첩j")),$$("#btn-add-roster").on("click",function(){if(1==checkInternetConnection()){$$("#btn-add-roster").attr("disabled",!0);var e=$$("#txt-roster-name").val(),t=$$("#txt-roster-position").val();if(""==e||null==e)return myApp.alert("Please enter roster name!"),$$("#btn-add-roster").removeAttr("disabled"),!1;if(""==imgfile)myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"add_roster.php",data:"account_id="+localStorage.getItem("account_id")+"&team_id="+localStorage.getItem("selectedTeamID")+"&roster_name="+e+"&roster_position="+t,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),"0"==e.status&&(clearRosterDetails(),mainView.router.loadPage("roster_add.html")),myApp.alert(e.message),$$("#btn-add-roster").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-add-roster").removeAttr("disabled")}});else{myApp.showIndicator();var a=new FileUploadOptions;a.fileKey="file",a.fileName=imgfile.substr(imgfile.lastIndexOf("/")+1),a.mimeType="image/jpeg",a.chunkedMode=!1;var i=new Object;i.account_id=localStorage.getItem("account_id"),i.team_id=localStorage.getItem("selectedTeamID"),i.roster_name=e,i.roster_position=t,a.params=i;var n=new FileTransfer;n.upload(imgfile,ENVYP_API_URL+"add_roster.php",winRoster,fail,a),clearRosterDetails(),$$("#btn-add-roster").removeAttr("disabled")}}})}),myApp.onPageInit("roster-detail",function(e){"1"==localStorage.getItem("selectedLanguage")?$("#lbl-roster-detail").append("Roster Detail"):$("#lbl-roster-detail").append("mandskab detalje"),3==localStorage.getItem("selectedSportID")||4==localStorage.getItem("selectedSportID")?($("#li-roster-det-fouls").hide(),$("#lbl-roster-det-score").append("goals/m책l"),$("#lbl-roster-det-assists").append("assists"),$("#lbl-roster-det-yellowcard").append("yellow card"),$("#lbl-roster-det-redcard").append("red card"),$("#lbl-roster-det-votes").append("votes"),$("#lbl-roster-det-mvp").append("mvp")):2==localStorage.getItem("selectedSportID")||5==localStorage.getItem("selectedSportID")?($("#li-roster-det-yellowcard").hide(),$("#li-roster-det-redcard").hide(),$("#lbl-roster-det-score").append("goals/m책l"),$("#lbl-roster-det-assists").append("assists"),$("#lbl-roster-det-fouls").append("fouls/minutes"),$("#lbl-roster-det-votes").append("votes"),$("#lbl-roster-det-mvp").append("mvp")):(1==localStorage.getItem("selectedSportID")||6==localStorage.getItem("selectedSportID"))&&($("#li-roster-det-yellowcard").hide(),$("#li-roster-det-redcard").hide(),$("#lbl-roster-det-score").append("points"),$("#lbl-roster-det-assists").append("assists"),$("#lbl-roster-det-fouls").append("fouls"),$("#lbl-roster-det-votes").append("votes"),$("#lbl-roster-det-mvp").append("mvp")),localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")&&$("#btn-edit-roster-detail").hide(),$$("#roster-detail-name").prepend(e.query.roster_name),$$("#roster-detail-position").prepend(e.query.roster_position),$$("#roster-detail-image").attr("data-src",""==e.query.roster_image||null==e.query.roster_image?"img/profile.jpg":e.query.roster_image),$$("#roster-detail-image").addClass("lazy lazy-fadein"),myApp.initImagesLazyLoad(e.container),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_roster_average_stats.php?roster_id="+e.query.roster_id,function(e){$.each(e,function(e,t){$("#roster-ppg").prepend(t.ppg),$("#roster-apg").prepend(t.apg),$("#roster-fpg").prepend(t.fpg),$("#roster-yellowcard").prepend(t.yellowcard),$("#roster-redcard").prepend(t.redcard),$("#roster-votes").prepend(t.votes),$("#roster-mvp").prepend(t.mvp_count)}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$$("#btn-edit-roster-detail").on("click",function(){mainView.router.loadPage("roster_edit.html?roster_id="+e.query.roster_id+"&roster_name="+e.query.roster_name+"&roster_position="+e.query.roster_position+"&roster_image="+e.query.roster_image)})}),myApp.onPageInit("roster-edit",function(e){"1"==localStorage.getItem("selectedLanguage")?($("#lbl-edit-roster").append("Edit Roster"),$("#lbl-roster-edit-image").append("Image"),$("#lbl-roster-edit-name").append("Roster name"),$("#lbl-roster-edit-position").append("Position"),$("#btn-update-roster").append("Continue")):($("#lbl-edit-roster").append("Rediger vagtplan"),$("#lbl-roster-edit-image").append("Billede"),$("#lbl-roster-edit-name").append("mandskab navn"),$("#lbl-roster-edit-position").append("Position"),$("#btn-update-roster").append("tilf첩j")),$$("#edit-txt-roster-name").attr("value",e.query.roster_name),$$("#edit-txt-roster-position").attr("value",e.query.roster_position),$$("#edit-roster-image").attr("data-src",""==e.query.roster_image||null==e.query.roster_image?"img/profile.jpg":e.query.roster_image),$$("#edit-roster-image").addClass("lazy lazy-fadein"),myApp.initImagesLazyLoad(e.container),$$("#btn-update-roster").on("click",function(){if(1==checkInternetConnection()){$$("#btn-update-roster").attr("disabled",!0);var t=$$("#edit-txt-roster-name").val();$$("#edit-txt-roster-position").val();if(""==t||null==t)return myApp.alert("Please enter roster name!"),$$("#btn-update-roster").removeAttr("disabled"),!1;if(""==imgfile)myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"update_roster.php",data:"account_id="+localStorage.getItem("account_id")+"&roster_id="+e.query.roster_id+"&roster_name="+$$("#edit-txt-roster-name").val()+"&roster_position="+$$("#edit-txt-roster-position").val()+"&roster_image="+e.query.roster_image,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),"0"==e.status&&(clearEditRosterDetails(),mainView.router.loadPage("roster_list.html")),myApp.alert(e.message),$$("#btn-update-roster").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-update-roster").removeAttr("disabled")}});else{myApp.showIndicator();var a=new FileUploadOptions;a.fileKey="file",a.fileName=imgfile.substr(imgfile.lastIndexOf("/")+1),a.mimeType="image/jpeg",a.chunkedMode=!1;var i=new Object;i.account_id=localStorage.getItem("account_id"),i.roster_id=e.query.roster_id,i.roster_name=$$("#edit-txt-roster-name").val(),i.roster_position=$$("#edit-txt-roster-position").val(),a.params=i;var n=new FileTransfer;n.upload(imgfile,ENVYP_API_URL+"update_roster.php",win,fail,a),clearEditRosterDetails(),myApp.hideIndicator(),$$("#btn-update-roster").removeAttr("disabled"),mainView.router.loadPage("roster_list.html")}}})}),myApp.onPageInit("account-list",function(e){"1"==localStorage.getItem("selectedLanguage")?$("#lbl-account-list").append("Account List"):$("#lbl-account-list").append("liste konto"),myApp.closePanel();var t=new Array;if(1==checkInternetConnection()){var a=[];myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_account_list.php?team_id="+localStorage.getItem("selectedTeamID"),function(t){$.each(t,function(e,t){if("empty"==t.status);else{var i=""==t.image_url||null==t.image_url?"img/profile.jpg":t.image_url;a.push({account_id:t.account_id,account_name:t.first_name+" "+t.last_name,account_image:i,account_description:t.account_description})}});myApp.virtualList($$(e.container).find(".virtual-list"),{items:a,searchAll:function(e,t){for(var a=[],i=0;i<t.length;i++)(t[i].account_name.indexOf(e)>=0||""===e.trim())&&a.push(i);return a},template:'<li><label class="label-checkbox item-content"><input id="checkbox-participants" type="checkbox" name="ks-media-checkbox" value="{{account_id}}"/><div class="item-media"><img src="{{account_image}}" style="width:44px; height:44px;" height="44"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">{{account_name}}</div><div class="item-after"><i class="icon icon-form-checkbox"></i></div></div><div class="item-subtitle">{{account_description}}</div></div></label></li>',height:73});myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}else myApp.alert(NO_INTERNET_ALERT);$$("#btn-account-back-tm").on("click",function(e){$("input:checkbox[id=checkbox-participants]:checked").each(function(){t.push($(this).val())}),0!=t.length&&(myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"add_participant.php",data:"account_ids="+t+"&team_id="+localStorage.getItem("selectedTeamID")+"&team_name="+localStorage.getItem("selectedTeamName")+"&team_password="+localStorage.getItem("selectedTeamPassword")+"&created_by="+localStorage.getItem("account_id"),dataType:"json",success:function(e,t,a){if(myApp.hideIndicator(),0==e.status){if(""!=e.push_ids){var i={contents:{en:"You are invited to join "+localStorage.getItem("selectedTeamName")+" team"},include_player_ids:e.push_ids};window.plugins.OneSignal.postNotification(i,function(e){console.log("Notification Post Success:",e)},function(e){console.log("Notification Post Failed: ",e)})}getParticipantList()}else myApp.alert(e.message)},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT)}})),myApp.openPanel("right")})}),myApp.onPageInit("administrator-list",function(e){"1"==localStorage.getItem("selectedLanguage")?$("#lbl-administrator-list").append("Administrator List"):$("#lbl-administrator-list").append("administrator liste"),myApp.closePanel();var t=new Array;if(1==checkInternetConnection()){var a=[];myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_team_participant_list.php?team_id="+localStorage.getItem("selectedTeamID"),function(t){$.each(t,function(e,t){if("empty"==t.status);else{var i=""==t.image_url||null==t.image_url?"img/profile.jpg":t.image_url;a.push({account_id:t.account_id,account_name:t.first_name+" "+t.last_name,account_image:i,account_description:t.account_description})}});myApp.virtualList($$(e.container).find(".virtual-list"),{items:a,searchAll:function(e,t){for(var a=[],i=0;i<t.length;i++)(t[i].account_name.indexOf(e)>=0||""===e.trim())&&a.push(i);return a},template:'<li><label class="label-checkbox item-content"><input id="checkbox-administrator" type="checkbox" name="ks-media-checkbox" value="{{account_id}}"/><div class="item-media"><img src="{{account_image}}" style="width:44px; height:44px;"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">{{account_name}}</div><div class="item-after"><i class="icon icon-form-checkbox"></i></div></div><div class="item-subtitle">{{account_description}}</div></div></label></li>',height:73});myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}else myApp.alert(NO_INTERNET_ALERT);$$("#btn-admin-back-tm").on("click",function(e){$("input:checkbox[id=checkbox-administrator]:checked").each(function(){t.push($(this).val())}),0!=t.length&&(myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"add_team_administrator.php",data:"account_ids="+t+"&team_id="+localStorage.getItem("selectedTeamID"),dataType:"json",success:function(e,t,a){myApp.hideIndicator(),0==e.status?getTeamAdministratorList():myApp.alert(e.message)},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT)}})),myApp.openPanel("right")})}),myApp.onPageInit("tournament-add",function(e){"1"==localStorage.getItem("selectedLanguage")?($("#lbl-add-tournament").append("Add Tournament"),$("#lbl-add-tournament-image").append("Image"),$("#lbl-add-tournament-details").append("Details"),$("#lbl-add-tournament-opponent").append("Opponent"),$("#lbl-add-tournament-location").append("Location"),$("#lbl-add-tournament-date").append("Date"),$("#lbl-add-tournament-description").append("Description"),$("#btn-add-tournament").append("Continue")):($("#lbl-add-tournament").append("Tilf첩j turnering"),$("#lbl-add-tournament-image").append("Billede"),$("#lbl-add-tournament-details").append("Detaljer"),$("#lbl-add-tournament-opponent").append("Modstander"),$("#lbl-add-tournament-location").append("Beliggenhed"),$("#lbl-add-tournament-date").append("Dato"),$("#lbl-add-tournament-description").append("Beskrivelse"),$("#btn-add-tournament").append("tilf첩j"));var t=new google.maps.places.Autocomplete(document.getElementById("txt-tournament-location"));google.maps.event.addListener(t,"place_changed",function(){place=t.getPlace(),address=place.formatted_address,latitude=place.geometry.location.lat(),longitude=place.geometry.location.lng()}),$("#txt-tournament-date").val((new Date).toJSON().slice(0,16)),$$("#btn-add-tournament").on("click",function(){if(1==checkInternetConnection()){$$("#btn-add-tournament").attr("disabled",!0);var e=$$("#txt-opponent-name").val(),t=$$("#txt-tournament-date").val(),a=$$("#txt-tournament-description").val(),i=$$("#txt-tournament-location").val();if(""==e||null==e)return myApp.alert("Please enter opponent name!"),$$("#btn-add-tournament").removeAttr("disabled"),!1;if(""==imgfile)myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"add_tournament.php",data:"account_id="+localStorage.getItem("account_id")+"&team_id="+localStorage.getItem("selectedTeamID")+"&opponent="+e+"&tournament_date="+t+"&tournament_desc="+a+"&tournament_location="+i+"&longitude="+longitude+"&latitude="+latitude,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),"0"==e.status&&clearTournamentDetails(),myApp.alert(e.message),$$("#btn-add-tournament").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-add-tournament").removeAttr("disabled")}});else{myApp.showIndicator();var n=new FileUploadOptions;n.fileKey="file",n.fileName=imgfile.substr(imgfile.lastIndexOf("/")+1),n.mimeType="image/jpeg",n.chunkedMode=!1;var o=new Object;o.account_id=localStorage.getItem("account_id"),o.team_id=localStorage.getItem("selectedTeamID"),o.opponent=e,o.tournament_date=t,o.tournament_desc=a,o.tournament_location=i,o.longitude=longitude,o.latitude=latitude,n.params=o;var r=new FileTransfer;r.upload(imgfile,ENVYP_API_URL+"add_tournament.php",win,fail,n),clearTournamentDetails(),myApp.hideIndicator(),$$("#btn-add-tournament").removeAttr("disabled")}}})}),myApp.onPageInit("tournament-list",function(e){if("1"==localStorage.getItem("selectedLanguage")?$("#lbl-tournament-list").append("Tournament Plan"):$("#lbl-tournament-list").append("Turnerings plan"),localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")&&$("#btn-show-add-tournament").hide(),1==checkInternetConnection()){var t=[];myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_tournament_list.php?team_id="+localStorage.getItem("selectedTeamID")+"&time_id="+localStorage.getItem("time_id"),function(a){$.each(a,function(e,a){if("empty"==a.status)myApp.alert("No tournament yet :(");else{var i=""==a.image_url||null==a.image_url?"img/envp-icon-ldpi.png":a.image_url;t.push({tournament_id:a.tournament_id,opponent:a.opponent,tournament_date:a.tournament_date,tournament_image:i})}});myApp.virtualList($$(e.container).find(".virtual-list"),{items:t,searchAll:function(e,t){for(var a=[],i=0;i<t.length;i++)(t[i].roster_name.indexOf(e)>=0||""===e.trim())&&a.push(i);return a},template:'<li><a href="tournament_detail.html?tournament_id={{tournament_id}}" class="item-link item-content"><div class="item-media"><img data-src="{{tournament_image}}" style="width:44px; height:44px;" class="img-circle lazy lazy-fadein"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">{{opponent}}</div></div><div class="item-subtitle">{{tournament_date}}</div></div></a></li>',height:76});myApp.initImagesLazyLoad(e.container),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}else myApp.alert(NO_INTERNET_ALERT);$$("#btn-tournament-list-refresh").on("click",function(){mainView.router.reloadPage("tournament_list.html")})}),myApp.onPageInit("tournament-detail",function(e){imgfile="","1"==localStorage.getItem("selectedLanguage")?($("#lbl-tournament-detail").append("Detail"),$("#lbl-tournament-detail-roster").append("Roster"),$("#lbl-tournament-detail-stats").empty(),$("#lbl-tournament-detail-stats").append("Statistics"),$("#lbl-tournament-detail-fine-box").append("Fine Box"),$("#lbl-tournament-detail-mvp").append("MVP"),$("#lbl-tournament-detail-opponent").append("<b>Opponent</b>"),$("#lbl-tournament-detail-location").append("<b>Location</b>"),$("#lbl-tournament-detail-date").append("<b>Date</b>"),$("#lbl-tournament-detail-description").append("<b>Description</b>"),$("#btn-edit-tournament-details").append("Edit"),$("#lbl-tournament-detail-versus").append("Versus"),$("#lbl-tournament-detail-enter-vote").append("Enter your vote"),$("#lbl-tournament-detail-roster-vote").append("Roster"),$("#btn-submit-vote").append("Vote")):($("#lbl-tournament-detail").append("detaljer"),$("#lbl-tournament-detail-roster").append("mandskab"),$("#lbl-tournament-detail-stats").empty(),$("#lbl-tournament-detail-stats").append("Statistik"),$("#lbl-tournament-detail-fine-box").append("b첩dekasse"),$("#lbl-tournament-detail-mvp").append("MVP"),$("#lbl-tournament-detail-opponent").append("<b>Modstander</b>"),$("#lbl-tournament-detail-location").append("<b>Beliggenhed</b>"),$("#lbl-tournament-detail-date").append("<b>Dato</b>"),$("#lbl-tournament-detail-description").append("<b>Beskrivelse</b>"),$("#btn-edit-tournament-details").append("edit"),$("#lbl-tournament-detail-versus").append("Imod"),$("#lbl-tournament-detail-enter-vote").append("Indtast din stem"),$("#lbl-tournament-detail-roster-vote").append("mandskab"),$("#btn-submit-vote").append("Stem")),3==localStorage.getItem("selectedSportID")||4==localStorage.getItem("selectedSportID")?($(".col-team-fouls").hide(),$("#lbl-tournament-detail-score").append("goals/m책l"),$("#lbl-tournament-detail-assist").append("assists"),$("#lbl-tournament-detail-yellowcard").append("yellow card"),$("#lbl-tournament-detail-redcard").append("red card")):2==localStorage.getItem("selectedSportID")||5==localStorage.getItem("selectedSportID")?($(".col-yellowcard").hide(),$(".col-redcard").hide(),$("#lbl-tournament-detail-score").append("goals/m책l"),$("#lbl-tournament-detail-assist").append("assists"),$("#lbl-tournament-detail-foul").append("fouls/minutes")):(1==localStorage.getItem("selectedSportID")||6==localStorage.getItem("selectedSportID"))&&($(".col-yellowcard").hide(),$(".col-redcard").hide(),$("#lbl-tournament-detail-score").append("score"),$("#lbl-tournament-detail-assist").append("assists"),$("#lbl-tournament-detail-foul").append("foul")),localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")&&($("#btn-edit-tournament-details").hide(),$("#btn-edit-team-stats").hide(),$("#btn-submit-vote").hide(),$("#div-add-tournament-roster").hide(),$("#div-add-tournament-fine").hide()),$("#opponent-assists").hide(),$("#opponent-fouls").hide(),$("#opponent-yellowcard").hide(),$("#opponent-redcard").hide();var t="",a="",i="",n="",o="",r="",l="",s="";$$("#div-add-tournament-roster").hide(),$$("#div-add-tournament-fine").hide(),localStorage.setItem("selectedTournamentId",e.query.tournament_id);var d="",p=0,m=0,c=0,u=0,g=0,_="",y=0,f=0,v=0,I=0,A=0,h=0,b=0,S=0,T=0,R="",P="";$("#team-name").empty(),$("#opponent-name").empty(),$("#team-points").empty(),$("#opponent-points").empty(),$("#team-assists").empty(),$("#opponent-assists").empty(),$("#team-fouls").empty(),$("#opponent-fouls").empty(),$("#team-yellowcard").empty(),$("#opponent-yellowcard").empty(),$("#team-redcard").empty(),$("#opponent-redcard").empty(),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_tournament_stats.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(t){$.each(t,function(e,t){d=localStorage.getItem("selectedTeamName"),p=t.team_points,m=t.team_assists,c=t.team_fouls,u=t.team_yellowcard,g=t.team_redcard,_=t.opponent,y=t.opponent_points,f=t.opponent_assists,v=t.opponent_fouls,I=t.opponent_yellowcard,A=t.opponent_redcard,h=t.win,b=t.lose,draw=t.draw,S=t.tournament_status,T=t.voting_status,R=t.team_image,P=t.opponent_image});var a=0==S?"End game":"Game ended",i=0==T?"End vote":"Vote result";$$(".popop-tournament-options").on("click",function(){var e=this,t='<div id="popover-tournament" class="popover"><div class="popover-inner"><div class="list-block"><ul><li><a id="btn-end-tournament" href="#" onClick="endTournamentConfirmation('+S+');" class="item-link list-button">'+a+'</li><li><a id="btn-end-vote" href="#" onClick="endVoteConfirmation('+T+');" class="item-link list-button">'+i+"</li></ul></div></div></div>";myApp.popover(t,e)}),$$("#team-name").prepend(d),$$("#opponent-name").prepend(_),$$("#team-points").prepend(p),$$("#opponent-points").prepend(y),$$("#team-assists").prepend(m),$$("#opponent-assists").prepend(f),$$("#team-fouls").prepend(c),$$("#opponent-fouls").prepend(v),$$("#team-yellowcard").prepend(u),$$("#opponent-yellowcard").prepend(I),$$("#team-redcard").prepend(g),$$("#opponent-redcard").prepend(A),$$("#tournament-win-lose").prepend("W "+h+" - L "+b+" - D "+draw),$$("#tournament-score").prepend(p+" - "+y),""!=R&&void 0!=R&&$$("#img-tournament-det-team-image").attr("src",R),""!=P&&void 0!=P&&$$("#img-tournament-det-opp-image").attr("src",P),myApp.initImagesLazyLoad(e.container),"0"==S?$$("#tournament-status").prepend("Ongoing"):$$("#tournament-status").prepend("Final"),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$$("#btn-edit-team-stats").on("click",function(){mainView.router.loadPage("edit_tournament_stats.html?team_name="+d+"&opponent_name="+_+"&team_points="+p+"&opponent_points="+y+"&team_assists="+m+"&opponent_assists="+f+"&team_fouls="+c+"&opponent_fouls="+v+"&team_yellowcard="+u+"&team_redcard="+g+"&opponent_yellowcard="+I+"&opponent_redcard="+A)}),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_tournament_detail.php?tournament_id="+localStorage.getItem("selectedTournamentId")+"&time_id="+localStorage.getItem("time_id"),function(e){$.each(e,function(e,d){t=d.opponent,a=d.location,i=d.tournament_date,n=d.description,o=d.image_url,r=d.longitude,l=d.latitude,s=d.formatted_date}),$$("#txt-opponent-name").prepend(t),$$("#txt-tournament-location").prepend(a),$$("#txt-tournament-date").prepend(i),$$("#txt-tournament-description").prepend(""==n||null==n?"No description":n),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$$("#btn-edit-tournament-details").on("click",function(){mainView.router.loadPage("tournament_edit.html?tournament_id="+e.query.tournament_id+"&opponent="+t+"&location="+a+"&date="+i+"&description="+n+"&image_url="+o+"&longitude="+r+"&latitude="+l+"&formatted_date="+s)}),$$("#btn-tournament-refresh").on("click",function(){mainView.router.reloadPage("tournament_detail.html?tournament_id="+localStorage.getItem("selectedTournamentId"))}),$("#roster_list").empty(),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_tournament_roster.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(e){$.each(e,function(e,t){if("empty"==t.status)$("#roster_list").append("<li><center><p>No roster</p><center></li>");else{if(""==t.image_url||null==t.image_url)var a="<img src='img/profile.jpg' class='img-circle' style='width:44px; height:44px;'>";else var a="<img src='"+t.image_url+"' class='img-circle' style='width:44px; height:44px;'>";$("#roster_list").append('<li><a href="roster_tournament_stats.html?roster_id='+t.roster_id+"&roster_name="+t.name+"&roster_position="+t.position+"&roster_image="+t.image_url+'" class="item-link item-content"><div class="item-media">'+a+'</div><div class="item-inner"><div class="item-title-row"><div class="item-title">'+t.name+'</div></div><div class="item-subtitle">'+t.position+"</div></div></a></li>")}}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$("#fine_list").empty(),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_roster_fine.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(e){$.each(e,function(e,t){if("empty"==t.status)$("#fine_list").append("<li><center><p>No fine</p><center></li>");else{if(""==t.image_url||null==t.image_url)var a="<img src='img/profile.jpg' class='img-circle' style='width:44px; height:44px;'>";else var a="<img src='"+t.image_url+"' class='img-circle' style='width:44px; height:44px;'>";$("#fine_list").append('<li><a href="fine_detail.html?name='+t.name+"&image_url="+t.image_url+"&price="+t.price+"&description="+t.fine+'" class="item-link item-content"><div class="item-media">'+a+'</div><div class="item-inner"><div class="item-title-row"><div class="item-title">'+t.name+'</div><div class="item-after">'+t.price+'</div></div><div class="item-subtitle"></div><div class="item-text">'+t.fine+"</div></div></a></li>")}}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$.getJSON(ENVYP_API_URL+"check_if_already_voted.php?tournament_id="+localStorage.getItem("selectedTournamentId")+"&account_id="+localStorage.getItem("account_id"),function(e){$.each(e,function(e,t){1==t.status?($$("#div-vote-add").hide(),$$("#div-vote-result").show()):($$("#div-vote-add").show(),$$("#div-vote-result").hide())}),1==T&&($$("#div-vote-add").hide(),$$("#div-vote-result").show())}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$("#vote_list").empty(),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_roster_vote_list.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(e){$.each(e,function(e,t){if("empty"==t.status)$("#vote_list").append("<li><center><p>No votes</p><center></li>");else{if(""==t.image_url||null==t.image_url)var a="<img src='img/profile.jpg' class='img-circle' style='width:44px; height:44px;'>";else var a="<img src='"+t.image_url+"' class='img-circle' style='width:44px; height:44px;'>";$("#vote_list").append('<li><div class="item-content"><div class="item-media">'+a+'</div><div class="item-inner"><div class="item-title">'+t.name+'</div><div class="item-after">Votes: '+t.votes+"</div></div></div></li>")}}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$("#select-vote-list").empty(),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_tournament_roster_vote_list.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(e){$("#select-vote-list").prepend('<option value="" selected="selected">Select a roster</option>'),$.each(e,function(e,t){"empty"==t.status||$("#select-vote-list").append('<option value="'+t.roster_id+'">'+t.name+"</option>")}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$$("#detail").on("show",function(){$$("#div-add-tournament-roster").hide(),$$("#div-add-tournament-fine").hide()}),$$("#roster").on("show",function(){localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")||$$("#div-add-tournament-roster").show(),$$("#div-add-tournament-fine").hide()}),$$("#stats").on("show",function(){$$("#div-add-tournament-roster").hide(),$$("#div-add-tournament-fine").hide()}),$$("#fine").on("show",function(){$$("#div-add-tournament-roster").hide(),localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")||$$("#div-add-tournament-fine").show()}),$$("#mvp").on("show",function(){$$("#div-add-tournament-roster").hide(),$$("#div-add-tournament-fine").hide(),$$("#btn-submit-vote").on("click",function(){$$("#btn-submit-vote").attr("disabled",!0);var e=$$("#select-vote-list").val();return""==e||null==e?(myApp.alert("Please select a roster!"),$$("#btn-submit-vote").removeAttr("disabled"),!1):(myApp.showIndicator(),void $$.ajax({type:"POST",url:ENVYP_API_URL+"add_vote.php",data:"account_id="+localStorage.getItem("account_id")+"&tournament_id="+localStorage.getItem("selectedTournamentId")+"&roster_id="+$$("#select-vote-list").val(),dataType:"json",success:function(e,t,a){myApp.hideIndicator(),0==e.status?(myApp.alert(e.message),$$("#div-vote-add").hide(),$$("#div-vote-result").show(),$("#vote_list").empty(),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_roster_vote_list.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(e){$.each(e,function(e,t){if("empty"==t.status)$("#vote_list").append("<li><center><p>No votes</p><center></li>");else{if(""==t.image_url||null==t.image_url)var a="<img src='img/profile.jpg' class='img-circle' style='width:44px; height:44px;'>";else var a="<img src='"+t.image_url+"' class='img-circle' style='width:44px; height:44px;'>";$("#vote_list").append('<li><div class="item-content"><div class="item-media">'+a+'</div><div class="item-inner"><div class="item-title">'+t.name+'</div><div class="item-after">Votes: '+t.votes+"</div></div></div></li>")}}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})):myApp.alert(e.message),$$("#btn-submit-vote").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-submit-vote").removeAttr("disabled")}}))})})}),myApp.onPageInit("voting-result",function(e){"1"==localStorage.getItem("selectedLanguage")?$("#lbl-mvp-result").append("MVP Result"):$("#lbl-mvp-result").append("MVP Resultat"),3==localStorage.getItem("selectedSportID")||4==localStorage.getItem("selectedSportID")?($("#li-mvp-fouls").hide(),$("#lbl-mvp-points").append("goals/m책l"),$("#lbl-mvp-assists").append("assists"),$("#lbl-mvp-yellowcard").append("yellow card"),$("#lbl-mvp-redcard").append("red card"),$("#lbl-mvp-votes").append("votes")):2==localStorage.getItem("selectedSportID")||5==localStorage.getItem("selectedSportID")?($("#li-mvp-yellowcard").hide(),$("#li-mvp-redcard").hide(),$("#lbl-mvp-points").append("goals/m책l"),$("#lbl-mvp-assists").append("assists"),$("#lbl-mvp-fouls").append("fouls"),$("#lbl-mvp-votes").append("votes")):(1==localStorage.getItem("selectedSportID")||6==localStorage.getItem("selectedSportID"))&&($("#li-mvp-yellowcard").hide(),$("#li-mvp-redcard").hide(),$("#lbl-mvp-points").append("points"),$("#lbl-mvp-assists").append("assists"),$("#lbl-mvp-fouls").append("fouls"),$("#lbl-mvp-votes").append("votes"));var t="",a="",i="",n="",o=0,r=0,l=0,s=0,d=0,p=0;myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_mvp.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(m){$.each(m,function(e,m){t=m.team_name,a=m.opponent_name,i=m.roster_name,o=m.points,r=m.assists,l=m.fouls,s=m.yellowcard,d=m.redcard,p=m.votes,n=m.roster_image}),$$("#img-mvp-image").attr("data-src",""==n||null==n?"img/profile.jpg":n),$$("#img-mvp-image").addClass("lazy lazy-fadein"),myApp.initImagesLazyLoad(e.container),$$("#mvp-name").prepend(i),$$("#mvp-opponent").prepend("vs "+a),
$$("#mvp-points").prepend(o),$$("#mvp-assists").prepend(r),$$("#mvp-fouls").prepend(l),$$("#mvp-yellowcard").prepend(s),$$("#mvp-redcard").prepend(d),$$("#mvp-votes").prepend(p),localStorage.setItem("mvp_team_name",t),localStorage.setItem("mvp_opponent_name",a),localStorage.setItem("mvp_roster_name",i),localStorage.setItem("mvp_roster_image",n),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$$(".popop-voting-result").on("click",function(){var e=this,t='<div id="popover-tournament" class="popover"><div class="popover-inner"><div class="list-block"><ul><li><a id="btn-fb-share href="#" onClick="shareMVPOnFacebook('+o+","+r+","+l+","+s+","+d+","+p+');" class="item-link list-button"><img src="img/icon-fb-share.png" style="width:20px; height:20px" /> Facebook</li><li><a id="btn-instagram-share" href="#" onClick="shareMVPOnInstagram('+o+","+r+","+l+","+s+","+d+","+p+');" class="item-link list-button"><img src="img/icon-instagram-share.png" style="width:20px; height:20px" /> Instagram</li><li><a id="btn-twitter-share" href="#" onclick="shareMVPOnTwitter('+o+","+r+","+l+","+s+","+d+","+p+');" class="item-link list-button"><img src="img/icon-twitter-share.png" style="width:20px; height:20px" /> Twitter</li></ul></div></div></div>';myApp.popover(t,e)}),$$("#btn-back-tour-det").on("click",function(){mainView.router.loadPage("tournament_detail.html?tournament_id="+localStorage.getItem("selectedTournamentId"))})}),3==localStorage.getItem("selectedSportID")||4==localStorage.getItem("selectedSportID")?($("#li-mvp-fouls").hide(),$("#lbl-mvp-points").append("goals/m책l"),$("#lbl-mvp-assists").append("assists"),$("#lbl-mvp-yellowcard").append("yellow card"),$("#lbl-mvp-redcard").append("red card"),$("#lbl-mvp-votes").append("votes")):2==localStorage.getItem("selectedSportID")||5==localStorage.getItem("selectedSportID")?($("#li-mvp-yellowcard").hide(),$("#li-mvp-redcard").hide(),$("#lbl-mvp-points").append("goals/m책l"),$("#lbl-mvp-assists").append("assists"),$("#lbl-mvp-fouls").append("fouls"),$("#lbl-mvp-votes").append("votes")):(1==localStorage.getItem("selectedSportID")||6==localStorage.getItem("selectedSportID"))&&($("#li-mvp-yellowcard").hide(),$("#li-mvp-redcard").hide(),$("#lbl-mvp-points").append("points"),$("#lbl-mvp-assists").append("assists"),$("#lbl-mvp-fouls").append("fouls"),$("#lbl-mvp-votes").append("votes")),myApp.onPageInit("fine-detail",function(e){"1"==localStorage.getItem("selectedLanguage")?($("#lbl-fine-detail").append("Fine Detail"),$("#lbl-fine-detail-description").append("Description"),$("#lbl-fine-detail-price").append("Price")):($("#lbl-fine-detail").append("Fin detalje"),$("#lbl-fine-detail-description").append("Beskrivelse"),$("#lbl-fine-detail-price").append("spillere/deltagere")),$$("#fine-detail-name").prepend(e.query.name),$$("#fine-detail-description").prepend(e.query.description),$$("#fine-detail-price").prepend(e.query.price),$$("#fine-detail-image").attr("data-src",""==e.query.image_url||null==e.query.image_url?"img/profile.jpg":e.query.image_url),$$("#fine-detail-image").addClass("lazy lazy-fadein"),myApp.initImagesLazyLoad(e.container)}),myApp.onPageInit("tournament-edit",function(e){"1"==localStorage.getItem("selectedLanguage")?($("#lbl-edit-tournament").append("Edit Tournament"),$("#lbl-edit-tournament-image").append("Image"),$("#lbl-edit-tournament-details").append("Details"),$("#lbl-edit-tournament-opponent").append("Opponent"),$("#lbl-edit-tournament-location").append("Location"),$("#lbl-edit-tournament-date").append("Date"),$("#lbl-edit-tournament-description").append("Description"),$("#btn-update-tournament").append("Continue")):($("#lbl-edit-tournament").append("Rediger turnering"),$("#lbl-edit-tournament-image").append("Billede"),$("#lbl-edit-tournament-details").append("Detaljer"),$("#lbl-edit-tournament-opponent").append("Modstander"),$("#lbl-edit-tournament-location").append("Beliggenhed"),$("#lbl-edit-tournament-date").append("Dato"),$("#lbl-edit-tournament-description").append("Beskrivelse"),$("#btn-update-tournament").append("tilf첩j"));var t=new google.maps.places.Autocomplete(document.getElementById("edit-txt-tournament-location"));google.maps.event.addListener(t,"place_changed",function(){place=t.getPlace(),address=place.formatted_address,edit_latitude=place.geometry.location.lat(),edit_longitude=place.geometry.location.lng()}),$$("#edit-txt-opponent-name").prepend(e.query.opponent),$$("#edit-txt-tournament-location").prepend(e.query.location),$$("#edit-txt-tournament-date").val(e.query.formatted_date),$$("#edit-txt-tournament-description").prepend(e.query.description),edit_longitude=e.query.longitude,edit_latitude=e.query.latitude,$$("#edit-tournament-image").attr("data-src",""==e.query.image_url||null==e.query.image_url?"img/envp-icon-ldpi.png":e.query.image_url),$$("#edit-tournament-image").addClass("lazy lazy-fadein"),myApp.initImagesLazyLoad(e.container),$("#edit-txt-tournament-location").change(function(){edit_longitude="",edit_latitude=""}),$$("#btn-update-tournament").on("click",function(){if(1==checkInternetConnection()){$$("#btn-update-tournament").attr("disabled",!0);var t=$$("#edit-txt-opponent-name").val(),a=$$("#edit-txt-tournament-date").val(),i=$$("#edit-txt-tournament-description").val(),n=$$("#edit-txt-tournament-location").val();if(""==t||null==t)return myApp.alert("Please enter opponent name!"),$$("#btn-update-tournament").removeAttr("disabled"),!1;if(""==imgfile)myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"update_tournament.php",data:"account_id="+localStorage.getItem("account_id")+"&tournament_id="+localStorage.getItem("selectedTournamentId")+"&opponent="+t+"&tournament_date="+a+"&tournament_desc="+i+"&tournament_location="+n+"&longitude="+edit_longitude+"&latitude="+edit_latitude+"&tournament_image="+e.query.image_url,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),"0"==e.status&&(clearEditTournamentDetails(),mainView.router.loadPage("tournament_detail.html?tournament_id="+localStorage.getItem("selectedTournamentId"))),myApp.alert(e.message),$$("#btn-update-tournament").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-update-tournament").removeAttr("disabled")}});else{myApp.showIndicator();var o=new FileUploadOptions;o.fileKey="file",o.fileName=imgfile.substr(imgfile.lastIndexOf("/")+1),o.mimeType="image/jpeg",o.chunkedMode=!1;var r=new Object;r.account_id=localStorage.getItem("account_id"),r.tournament_id=localStorage.getItem("selectedTournamentId"),r.opponent=t,r.tournament_date=a,r.tournament_desc=i,r.tournament_location=n,r.longitude=longitude,r.latitude=latitude,o.params=r;var l=new FileTransfer;l.upload(imgfile,ENVYP_API_URL+"update_tournament.php",win,fail,o),clearTournamentDetails(),myApp.hideIndicator(),$$("#btn-update_tournament-tournament").removeAttr("disabled"),mainView.router.loadPage("tournament_detail.html?tournament_id="+localStorage.getItem("selectedTournamentId"))}}})}),myApp.onPageInit("tournament-fine-add",function(e){var t="";1==localStorage.getItem("currency_id")?t="USD":2==localStorage.getItem("currency_id")?t="DKK":3==localStorage.getItem("currency_id")?t="GBP":4==localStorage.getItem("currency_id")&&(t="EUR"),"1"==localStorage.getItem("selectedLanguage")?($("#lbl-create-fine").append("Create Fine"),$("#lbl-fine-add-details").append("Details"),$("#lbl-fine-add-roster").append("Roster"),$("#lbl-fine-add-fine").append("Fine"),$("#lbl-fine-add-price").append("Price ("+t+")")):($("#lbl-create-fine").append("Opret fint"),$("#lbl-fine-add-details").append("Detaljer"),$("#lbl-fine-add-roster").append("mandskab"),$("#lbl-fine-add-fine").append("B첩de"),$("#lbl-fine-add-price").append("Pris ("+t+")")),$("#select-roster-list").empty(),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_tournament_roster.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(e){$("#select-roster-list").prepend('<option value="" selected="selected">Select a roster</option>'),$.each(e,function(e,t){"empty"==t.status?myApp.alert("No roster yet :("):$("#select-roster-list").append('<option value="'+t.roster_id+'">'+t.name+"</option>")}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$$("#btn-add-fine").on("click",function(){if(1==checkInternetConnection()){$$("#btn-add-fine").attr("disabled",!0);var e=$$("#select-roster-list").val(),t=$$("#txt-fine-description").val(),a=$$("#txt-fine-price").val();if(""==e||null==e)return myApp.alert("Please select a roster!"),$$("#btn-add-fine").removeAttr("disabled"),!1;if(""==t||null==t)return myApp.alert("Please enter fine description!"),$$("#btn-add-fine").removeAttr("disabled"),!1;if(""==a||""==a)return myApp.alert("Please enter a price!"),$$("#btn-add-fine").removeAttr("disabled"),!1;myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"add_tournament_fine.php",data:"tournament_id="+localStorage.getItem("selectedTournamentId")+"&account_id="+localStorage.getItem("account_id")+"&roster_id="+e+"&fine="+t+"&price="+a+"&currency_id="+localStorage.getItem("currency_id"),dataType:"json",success:function(e,t,a){myApp.hideIndicator(),0==e.status?(myApp.alert(e.message),$("#fine_list").empty(),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_roster_fine.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(e){$.each(e,function(e,t){if("empty"==t.status)$("#fine_list").append("<li><center><p>No fine</p><center></li>");else{if(""==t.image_url||null==t.image_url)var a="<img src='img/profile.jpg' class='img-circle' style='width:44px; height:44px;'>";else var a="<img src='"+t.image_url+"' class='img-circle' style='width:44px; height:44px;'>";$("#fine_list").append('<li><a href="fine_detail.html?name='+t.name+"&image_url="+t.image_url+"&price="+t.price+"&description="+t.fine+'" class="item-link item-content"><div class="item-media">'+a+'</div><div class="item-inner"><div class="item-title-row"><div class="item-title">'+t.name+'</div><div class="item-after">'+t.price+'</div></div><div class="item-subtitle"></div><div class="item-text">'+t.fine+"</div></div></a></li>")}}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})):myApp.alert(e.message),$$("#btn-add-fine").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-add-fine").removeAttr("disabled")}})}})}),myApp.onPageInit("roster-tournament-stats",function(e){"1"==localStorage.getItem("selectedLanguage")?$("#lbl-roster-statistics").append("Roster Statistics"):$("#lbl-roster-statistics").append("mandskab statistik"),3==localStorage.getItem("selectedSportID")||4==localStorage.getItem("selectedSportID")?($("#li-roster-fouls").hide(),$("#lbl-roster-tournament-points").append("goals/m책l"),$("#lbl-roster-tournament-assists").append("assists"),$("#lbl-roster-tournament-yellowcard").append("yellow card"),$("#lbl-roster-tournament-redcard").append("red card"),$("#lbl-roster-tournament-votes").append("votes")):2==localStorage.getItem("selectedSportID")||5==localStorage.getItem("selectedSportID")?($("#li-roster-yellowcard").hide(),$("#li-roster-redcard").hide(),$("#lbl-roster-tournament-points").append("goals/m책l"),$("#lbl-roster-tournament-assists").append("assists"),$("#lbl-roster-tournament-fouls").append("fouls"),$("#lbl-roster-tournament-votes").append("votes")):(1==localStorage.getItem("selectedSportID")||6==localStorage.getItem("selectedSportID"))&&($("#li-roster-yellowcard").hide(),$("#li-roster-redcard").hide(),$("#lbl-roster-tournament-points").append("points"),$("#lbl-roster-tournament-assists").append("assists"),$("#lbl-roster-tournament-fouls").append("fouls"),$("#lbl-roster-tournament-votes").append("votes")),localStorage.getItem("currentTeamAdmin")!=localStorage.getItem("account_id")&&0==localStorage.getItem("currentAccountIsTeamAdmin")&&($("#btn-edit-roster-stats").hide(),$("#btn-delete-tournament-roster").hide());var t=0,a=0,i=0,n=0,o=0,r=0;$$("#roster-image").attr("data-src",""==e.query.roster_image||null==e.query.roster_image?"img/profile.jpg":e.query.roster_image),$$("#roster-image").addClass("lazy lazy-fadein"),myApp.initImagesLazyLoad(e.container),$$("#roster-name").prepend(e.query.roster_name),$$("#roster-position").prepend(e.query.roster_position),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_roster_tournament_stats.php?tournament_id="+localStorage.getItem("selectedTournamentId")+"&roster_id="+e.query.roster_id,function(e){$.each(e,function(e,l){t=l.points,a=l.assists,i=l.fouls,n=l.yellowcard,o=l.redcard,r=l.votes}),$$("#roster-points").prepend(t),$$("#roster-assists").prepend(a),$$("#roster-fouls").prepend(i),$$("#roster-yellowcard").prepend(n),$$("#roster-redcard").prepend(o),$$("#roster-votes").prepend(r),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$$("#btn-edit-roster-stats").on("click",function(){mainView.router.loadPage("edit_roster_tournament_stats.html?roster_id="+e.query.roster_id+"&roster_name="+e.query.roster_name+"&roster_position="+e.query.roster_position+"&points="+t+"&assists="+a+"&fouls="+i+"&yellowcard="+n+"&redcard="+o)}),$$("#btn-delete-tournament-roster").on("click",function(){myApp.confirm("Are you sure? All votes and fines in this tournament will be lost once you remove this roster.",function(){$$.ajax({type:"POST",url:ENVYP_API_URL+"delete_tournament_roster.php",data:"roster_id="+e.query.roster_id+"&tournament_id="+localStorage.getItem("selectedTournamentId"),dataType:"json",success:function(e,t,a){mainView.router.loadPage("tournament_detail.html?tournament_id="+localStorage.getItem("selectedTournamentId"))},error:function(e,t,a){myApp.alert(ERROR_ALERT)}})})})}),myApp.onPageInit("edit-roster-tournament-stats",function(e){"1"==localStorage.getItem("selectedLanguage")?$("#lbl-edit-statistics").append("Roster Statistics"):$("#lbl-roster-statistics").append("mandskab statistik"),3==localStorage.getItem("selectedSportID")||4==localStorage.getItem("selectedSportID")?($("#li-edit-roster-fouls").hide(),$("#lbl-edit-roster-statistics-points").append("goals/m책l"),$("#lbl-edit-roster-statistics-assists").append("assists"),$("#lbl-edit-roster-statistics-yellowcard").append("yellow card"),$("#lbl-edit-roster-statistics-redcard").append("red card")):2==localStorage.getItem("selectedSportID")||5==localStorage.getItem("selectedSportID")?($("#li-edit-roster-yellowcard").hide(),$("#li-edit-roster-redcard").hide(),$("#lbl-edit-roster-statistics-points").append("goals/m책l"),$("#lbl-edit-roster-statistics-assists").append("assists"),$("#lbl-edit-roster-statistics-fouls").append("fouls")):(1==localStorage.getItem("selectedSportID")||6==localStorage.getItem("selectedSportID"))&&($("#li-edit-roster-yellowcard").hide(),$("#li-edit-roster-redcard").hide(),$("#lbl-edit-roster-statistics-points").append("points"),$("#lbl-edit-roster-statistics-assists").append("assists"),$("#lbl-edit-roster-statistics-fouls").append("fouls")),$$("#edit-roster-name").prepend(e.query.roster_name),$$("#edit-roster-position").prepend(e.query.roster_position),$$("#edit-roster-points").attr("value",e.query.points),$$("#edit-roster-assists").attr("value",e.query.assists),$$("#edit-roster-fouls").attr("value",e.query.fouls),$$("#edit-roster-yellowcard").attr("value",e.query.yellowcard),$$("#edit-roster-redcard").attr("value",e.query.redcard),$("#edit-roster-assists").focusTextToEnd(),$("#edit-roster-fouls").focusTextToEnd(),$("#edit-roster-yellowcard").focusTextToEnd(),$("#edit-roster-redcard").focusTextToEnd(),$("#edit-roster-points").focusTextToEnd(),$$("#btn-update-roster-stats").on("click",function(){if(1==checkInternetConnection()){$$("#btn-update-roster-stats").attr("disabled",!0);var t=$$("#edit-roster-points").val(),a=$$("#edit-roster-assists").val(),i=$$("#edit-roster-fouls").val(),n=$$("#edit-roster-yellowcard").val(),o=$$("#edit-roster-redcard").val();if(""==t||null==t)return myApp.alert("Please enter points!"),$$("#btn-update-roster-stats").removeAttr("disabled"),!1;if(""==a||null==a)return myApp.alert("Please enter assists!"),$$("#btn-update-roster-stats").removeAttr("disabled"),!1;if(""==i||null==i)return myApp.alert("Please enter fouls!"),$$("#btn-update-roster-stats").removeAttr("disabled"),!1;if(""==n||null==n)return myApp.alert("Please enter yellow card!"),$$("#btn-update-roster-stats").removeAttr("disabled"),!1;if(""==o||null==o)return myApp.alert("Please enter red card!"),$$("#btn-update-roster-stats").removeAttr("disabled"),!1;myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"update_roster_tournament_stats.php",data:"account_id="+localStorage.getItem("account_id")+"&tournament_id="+localStorage.getItem("selectedTournamentId")+"&roster_id="+e.query.roster_id+"&points="+t+"&assists="+a+"&fouls="+i+"&yellowcard="+n+"&redcard="+o,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),"0"==e.status&&mainView.router.loadPage("tournament_detail.html?tournament_id="+localStorage.getItem("selectedTournamentId")),myApp.alert(e.message),$$("#btn-update-roster-stats").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-update-roster-stats").removeAttr("disabled")}})}})}),myApp.onPageInit("edit-tournament-stats",function(e){"1"==localStorage.getItem("selectedLanguage")?$("#lbl-edit-team-statistics").append("Edit Statistics"):$("#lbl-edit-team-statistics").append("Rediger statistik"),$("#li-opp-assists").hide(),$("#li-opp-fouls").hide(),$("#li-opp-yellowcard").hide(),$("#li-opp-redcard").hide(),$$("#txt-edit-team-name").prepend("Team: <b>"+e.query.team_name+"</b>"),$$("#txt-edit-opponent-name").prepend("Opponent: <b>"+e.query.opponent_name+"</b>"),$$("#txt-edit-team-points").attr("value",e.query.team_points),$$("#txt-edit-team-assists").attr("value",e.query.team_assists),$$("#txt-edit-team-fouls").attr("value",e.query.team_fouls),$$("#txt-edit-team-yellowcard").attr("value",e.query.team_yellowcard),$$("#txt-edit-team-redcard").attr("value",e.query.team_redcard),$$("#txt-edit-opponent-points").attr("value",e.query.opponent_points),$$("#txt-edit-opponent-assists").attr("value",e.query.opponent_assists),$$("#txt-edit-opponent-fouls").attr("value",e.query.opponent_fouls),$$("#txt-edit-opponent-yellowcard").attr("value",e.query.opponent_yellowcard),$$("#txt-edit-opponent-redcard").attr("value",e.query.opponent_redcard),$("#txt-edit-team-name").focusTextToEnd(),$("#txt-edit-opponent-name").focusTextToEnd(),$("#txt-edit-team-points").focusTextToEnd(),$("#txt-edit-team-assists").focusTextToEnd(),$("#txt-edit-team-fouls").focusTextToEnd(),$("#txt-edit-team-yellowcard").focusTextToEnd(),$("#txt-edit-team-redcard").focusTextToEnd(),$("#txt-edit-opponent-points").focusTextToEnd(),$("#txt-edit-opponent-assists").focusTextToEnd(),$("#txt-edit-opponent-fouls").focusTextToEnd(),$("#txt-edit-opponent-yellowcard").focusTextToEnd(),$("#txt-edit-opponent-redcard").focusTextToEnd(),3==localStorage.getItem("selectedSportID")||4==localStorage.getItem("selectedSportID")?($("#li-team-fouls").hide(),$("#li-opp-fouls").hide(),$("#lbl-edit-team-points").append("goals/m책l"),$("#lbl-edit-team-assists").append("assists"),$("#lbl-edit-team-yellowcard").append("Yellow card"),$("#lbl-edit-team-redcard").append("Red card"),$("#lbl-edit-opp-points").append("goals/m책l"),$("#lbl-edit-opp-assists").append("assists"),$("#lbl-edit-opp-yellowcard").append("yellow card"),$("#lbl-edit-opp-redcard").append("red card")):2==localStorage.getItem("selectedSportID")||5==localStorage.getItem("selectedSportID")?($("#li-team-yellowcard").hide(),$("#li-team-redcard").hide(),$("#li-opp-yellowcard").hide(),$("#li-opp-redcard").hide(),$("#lbl-edit-team-points").append("goals/m책l"),$("#lbl-edit-team-assists").append("assists"),$("#lbl-edit-team-fouls").append("fouls/minutes"),$("#lbl-edit-opp-points").append("goals/m책l"),$("#lbl-edit-opp-assists").append("assists"),$("#lbl-edit-opp-fouls").append("fouls/minutes")):(1==localStorage.getItem("selectedSportID")||6==localStorage.getItem("selectedSportID"))&&($("#li-team-yellowcard").hide(),$("#li-team-redcard").hide(),$("#li-opp-yellowcard").hide(),$("#li-opp-redcard").hide(),$("#lbl-edit-team-points").append("points"),$("#lbl-edit-team-assists").append("assists"),$("#lbl-edit-team-fouls").append("fouls"),$("#lbl-edit-opp-points").append("points"),$("#lbl-edit-opp-assists").append("assists"),$("#lbl-edit-opp-fouls").append("fouls")),$$("#btn-update-tournament-stats").on("click",function(){if(1==checkInternetConnection()){$$("#btn-update-tournament-stats").attr("disabled",!0);var e=$$("#txt-edit-team-points").val(),t=$$("#txt-edit-team-assists").val(),a=$$("#txt-edit-team-fouls").val(),i=$$("#txt-edit-team-yellowcard").val(),n=$$("#txt-edit-team-redcard").val(),o=$$("#txt-edit-opponent-points").val(),r=$$("#txt-edit-opponent-assists").val(),l=$$("#txt-edit-opponent-fouls").val(),s=$$("#txt-edit-opponent-yellowcard").val(),d=$$("#txt-edit-opponent-redcard").val();if(""==e||null==e)return myApp.alert("Please enter team points!"),$$("#btn-update-tournament-stats").removeAttr("disabled"),!1;if(""==t||null==t)return myApp.alert("Please enter team assists!"),$$("#btn-update-tournament-stats").removeAttr("disabled"),!1;if(""==a||null==a)return myApp.alert("Please enter team fouls!"),$$("#btn-update-tournament-stats").removeAttr("disabled"),!1;if(""==i||null==i)return myApp.alert("Please enter team yellow card!"),$$("#btn-update-tournament-stats").removeAttr("disabled"),!1;if(""==n||null==n)return myApp.alert("Please enter team red card!"),$$("#btn-update-tournament-stats").removeAttr("disabled"),!1;if(""==o||null==o)return myApp.alert("Please enter opponent points!"),$$("#btn-update-tournament-stats").removeAttr("disabled"),!1;if(""==r||null==r)return myApp.alert("Please enter oponent assists!"),$$("#btn-update-tournament-stats").removeAttr("disabled"),!1;if(""==l||null==l)return myApp.alert("Please enter opponent fouls!"),$$("#btn-update-tournament-stats").removeAttr("disabled"),!1;if(""==s||null==s)return myApp.alert("Please enter opponent yellow card!"),$$("#btn-update-tournament-stats").removeAttr("disabled"),!1;if(""==d||null==d)return myApp.alert("Please enter opponent red card!"),$$("#btn-update-tournament-stats").removeAttr("disabled"),!1;myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"update_tournament_stats.php",data:"account_id="+localStorage.getItem("account_id")+"&tournament_id="+localStorage.getItem("selectedTournamentId")+"&team_points="+e+"&team_assists="+t+"&team_fouls="+a+"&team_yellowcard="+i+"&team_redcard="+n+"&opponent_points="+o+"&opponent_assists="+r+"&opponent_fouls="+l+"&opponent_yellowcard="+s+"&opponent_redcard="+d,dataType:"json",success:function(e,t,a){myApp.hideIndicator(),"0"==e.status&&mainView.router.loadPage("tournament_detail.html?tournament_id="+localStorage.getItem("selectedTournamentId")),myApp.alert(e.message),$$("#btn-update-tournament-stats").removeAttr("disabled")},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT),$$("#btn-update-tournament-stats").removeAttr("disabled")}})}})}),myApp.onPageInit("tournament-roster-list",function(e){"1"==localStorage.getItem("selectedLanguage")?$("#lbl-tournament-roster-list").append("Roster List"):$("#lbl-tournament-roster-list").append("mandskab liste");var t=new Array;if(1==checkInternetConnection()){var a=[];myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_tournament_roster_list.php?tournament_id="+localStorage.getItem("selectedTournamentId")+"&team_id="+localStorage.getItem("selectedTeamID"),function(t){$.each(t,function(e,t){if("empty"==t.status)myApp.alert("No roster available :(");else{var i=""==t.image_url||null==t.image_url?"img/profile.jpg":t.image_url;a.push({roster_id:t.roster_id,roster_name:t.roster_name,roster_position:t.roster_position,roster_image:i})}});myApp.virtualList($$(e.container).find(".virtual-list"),{items:a,searchAll:function(e,t){for(var a=[],i=0;i<t.length;i++)(t[i].roster_name.indexOf(e)>=0||""===e.trim())&&a.push(i);return a},template:'<li><label class="label-checkbox item-content"><input id="checkbox-roster" type="checkbox" name="ks-media-checkbox" value="{{roster_id}}"/><div class="item-media"><img src="{{roster_image}}" class="img-circle" style="width:44px; height:44px;"/></div><div class="item-inner"><div class="item-title-row"><div class="item-title">{{roster_name}}</div><div class="item-after"><i class="icon icon-form-checkbox"></i></div></div><div class="item-subtitle">{{roster_position}}</div></div></label></li>',height:73});myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})}else myApp.alert(NO_INTERNET_ALERT);$$("#btn-tournament-detail-back").on("click",function(e){$("input:checkbox[id=checkbox-roster]:checked").each(function(){t.push($(this).val())}),0!=t.length&&(myApp.showIndicator(),$$.ajax({type:"POST",url:ENVYP_API_URL+"add_roster_tournament.php",data:"roster_ids="+t+"&tournament_id="+localStorage.getItem("selectedTournamentId")+"&account_id="+localStorage.getItem("account_id"),dataType:"json",success:function(e,t,a){myApp.hideIndicator(),0==e.status?(myApp.alert(e.message),$("#roster_list").empty(),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_tournament_roster.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(e){$.each(e,function(e,t){if("empty"==t.status)$("#roster_list").append("<li><center><p>No roster</p><center></li>");else{if(""==t.image_url||null==t.image_url)var a="<img src='img/profile.jpg' class='img-circle' style='width:44px; height:44px;'>";else var a="<img src='"+t.image_url+"' class='img-circle' style='width:44px; height:44px;'>";$("#roster_list").append('<li><a href="roster_tournament_stats.html?roster_id='+t.roster_id+"&roster_name="+t.name+"&roster_position="+t.position+"&roster_image="+t.image_url+'" class="item-link item-content"><div class="item-media">'+a+'</div><div class="item-inner"><div class="item-title-row"><div class="item-title">'+t.name+'</div></div><div class="item-subtitle">'+t.position+"</div></div></a></li>")}}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)}),$("#select-vote-list").empty(),myApp.showIndicator(),$.getJSON(ENVYP_API_URL+"get_tournament_roster.php?tournament_id="+localStorage.getItem("selectedTournamentId"),function(e){$("#select-vote-list").prepend('<option value="" selected="selected">Select a roster</option>'),$.each(e,function(e,t){"empty"==t.status?myApp.alert("No roster yet :("):$("#select-vote-list").append('<option value="'+t.roster_id+'">'+t.name+"</option>")}),myApp.hideIndicator()}).fail(function(e,t,a){myApp.hideIndicator(),myApp.alert(AJAX_ERROR_ALERT)})):myApp.alert(e.message)},error:function(e,t,a){myApp.hideIndicator(),myApp.alert(ERROR_ALERT)}}))})});var fbLoginSuccess=function(e){"connected"===e.status?getFBDetails():"not_authorized"===e.status};!function(e){e.fn.focusTextToEnd=function(){this.focus();var e=this.val();return this.val("").val(e),this}}(jQuery);